"use strict";(self.webpackChunkseahub_frontend=self.webpackChunkseahub_frontend||[]).push([[745],{36555:function(e,t,r){var a=r(15671),s=r(43144),n=r(60136),i=r(29388),c=r(72791),o=r(54164),h=r(4918),g=r(95996),l=r(53585),u=r(22228),d=r(63446),f=r(43113),P=r(7141),p=r(37976),x=(r(58108),r(29470),r(80184)),m=function(e){(0,n.Z)(r,e);var t=(0,i.Z)(r);function r(e){var s;return(0,a.Z)(this,r),(s=t.call(this,e)).getItems=function(e){var t=s.state.perPage;u.I.listNotifications(e,t).then((function(r){s.setState({isLoading:!1,items:r.data.notification_list,currentPage:e,hasNextPage:g.c.hasNextPage(e,t,r.data.count)})})).catch((function(e){s.setState({isLoading:!1,errorMsg:g.c.getErrorMsg(e,!0)})}))},s.resetPerPage=function(e){s.setState({perPage:e},(function(){s.getItems(1)}))},s.onSearchedClick=function(e){if(!0===e.is_dir){var t=l.ze+"library/"+e.repo_id+"/"+e.repo_name+e.path;(0,h.c4)(t,{repalce:!0})}else{var r=l.ze+"lib/"+e.repo_id+"/file"+g.c.encodePath(e.path);window.open("about:blank").location.href=r}},s.markAllRead=function(){u.I.updateNotifications().then((function(e){s.setState({items:s.state.items.map((function(e){return e.seen=!0,e}))})})).catch((function(e){s.setState({isLoading:!1,errorMsg:g.c.getErrorMsg(e,!0)})}))},s.clearAll=function(){u.I.deleteNotifications().then((function(e){s.setState({items:[]})})).catch((function(e){s.setState({isLoading:!1,errorMsg:g.c.getErrorMsg(e,!0)})}))},s.state={isLoading:!0,errorMsg:"",currentPage:1,perPage:25,hasNextPage:!1,items:[]},s}return(0,s.Z)(r,[{key:"componentDidMount",value:function(){var e=this,t=new URL(window.location).searchParams,r=this.state,a=r.currentPage,s=r.perPage;this.setState({perPage:parseInt(t.get("per_page")||s),currentPage:parseInt(t.get("page")||a)},(function(){e.getItems(e.state.currentPage)}))}},{key:"render",value:function(){return(0,x.jsx)(c.Fragment,{children:(0,x.jsxs)("div",{className:"h-100 d-flex flex-column",children:[(0,x.jsxs)("div",{className:"top-header d-flex justify-content-between",children:[(0,x.jsx)("a",{href:l.ze,children:(0,x.jsx)("img",{src:l.si+l.j1,height:l.AN,width:l.Bv,title:l.y7,alt:"logo"})}),(0,x.jsx)(P.Z,{onSearchedClick:this.onSearchedClick})]}),(0,x.jsx)("div",{className:"flex-auto container-fluid pt-4 pb-6 o-auto",children:(0,x.jsx)("div",{className:"row",children:(0,x.jsxs)("div",{className:"col-md-10 offset-md-1",children:[(0,x.jsxs)("div",{className:"d-flex justify-content-between align-items-center flex-wrap op-bar",children:[(0,x.jsx)("h2",{className:"h4 m-0 my-1",children:(0,l.ih)("Notifications")}),(0,x.jsxs)("div",{children:[(0,x.jsx)("button",{className:"btn btn-secondary op-bar-btn",onClick:this.markAllRead,children:(0,l.ih)("Mark all read")}),(0,x.jsx)("button",{className:"btn btn-secondary op-bar-btn ml-2",onClick:this.clearAll,children:(0,l.ih)("Clear")})]})]}),(0,x.jsx)(j,{isLoading:this.state.isLoading,errorMsg:this.state.errorMsg,items:this.state.items,currentPage:this.state.currentPage,hasNextPage:this.state.hasNextPage,curPerPage:this.state.perPage,resetPerPage:this.resetPerPage,getListByPage:this.getItems})]})})})]})})}}]),r}(c.Component),j=function(e){(0,n.Z)(r,e);var t=(0,i.Z)(r);function r(e){var s;return(0,a.Z)(this,r),(s=t.call(this,e)).getPreviousPage=function(){s.props.getListByPage(s.props.currentPage-1)},s.getNextPage=function(){s.props.getListByPage(s.props.currentPage+1)},s}return(0,s.Z)(r,[{key:"render",value:function(){var e=this.props,t=e.isLoading,r=e.errorMsg,a=e.items,s=e.curPerPage,n=e.currentPage,i=e.hasNextPage;if(t)return(0,x.jsx)(d.Z,{});if(r)return(0,x.jsx)("p",{className:"error mt-6 text-center",children:r});var o=g.c.isDesktop()?[{width:"7%",text:""},{width:"73%",text:(0,l.ih)("Message")},{width:"20%",text:(0,l.ih)("Time")}]:[{width:"15%",text:""},{width:"52%",text:(0,l.ih)("Message")},{width:"33%",text:(0,l.ih)("Time")}];return(0,x.jsxs)(c.Fragment,{children:[(0,x.jsxs)("table",{className:"table-hover",children:[(0,x.jsx)("thead",{children:(0,x.jsx)("tr",{children:o.map((function(e,t){return(0,x.jsx)("th",{width:e.width,children:e.text},t)}))})}),(0,x.jsx)("tbody",{children:a.map((function(e,t){return(0,x.jsx)(p.Z,{noticeItem:e,tr:!0},t)}))})]}),a.length>0&&(0,x.jsx)(f.Z,{gotoPreviousPage:this.getPreviousPage,gotoNextPage:this.getNextPage,currentPage:n,hasNextPage:i,curPerPage:s,resetPerPage:this.props.resetPerPage})]})}}]),r}(c.Component);o.render((0,x.jsx)(m,{}),document.getElementById("wrapper"))}},function(e){e.O(0,[351],(function(){return t=36555,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=userNotifications.47fea091.js.map