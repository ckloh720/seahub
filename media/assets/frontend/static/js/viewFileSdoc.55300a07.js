"use strict";(self.webpackChunkseahub_frontend=self.webpackChunkseahub_frontend||[]).push([[539],{50906:function(e,n,t){var r=t(68825),a=t(38918),i=t(9522),o=t(39230),s=t(53585),c=window.app.config.lang,u=void 0===c?"en":c;r.ZP.use(a.Z).use(i.Z).use(o.Db).init({lng:u,fallbackLng:"en",ns:["sdoc-editor"],defaultNS:"sdoc-editor",whitelist:["en","zh-CN","fr","de","cs","es","es-AR","es-MX","ru"],backend:{loadPath:s.si+"sdoc-editor/locales/{{ lng }}/{{ ns }}.json"},debug:!1,interpolation:{escapeValue:!1},load:"currentOnly",react:{wait:!0}}),n.Z=r.ZP},87394:function(e,n,t){var r=t(72791),a=t(54164),i=t(39230),o=t(50906),s=t(95996),c=t(63446),u=t(15671),l=t(43144),d=t(60136),h=t(29388),g=t(76933),p=t(22228),S=t(51832),f=t(22386),m=t(65953),b=t(80184),v=function(e){(0,d.Z)(t,e);var n=(0,h.Z)(t);function t(e){var r;return(0,u.Z)(this,t),(r=n.call(this,e)).onInternalLinkToggle=function(){r.setState({isShowInternalLinkDialog:!r.state.isShowInternalLinkDialog})},r.unmark=function(){var e=r.props,n=e.repoID,t=e.docPath;p.I.sdocUnmarkAsDraft(n,t).then((function(e){r.props.unmarkDraft()})).catch((function(e){var n=s.c.getErrorMsg(e);S.Z.danger(n)}))},r.toggleStar=function(){var e=r.props,n=e.isStarred,t=e.repoID,a=e.docPath;n?p.I.unstarItem(t,a).then((function(e){r.props.toggleStar(!1)})).catch((function(e){var n=s.c.getErrorMsg(e);S.Z.danger(n)})):p.I.starItem(t,a).then((function(e){r.props.toggleStar(!0)})).catch((function(e){var n=s.c.getErrorMsg(e);S.Z.danger(n)}))},r.onShareToggle=function(){r.setState({isShowShareDialog:!r.state.isShowShareDialog})},r.state={isShowInternalLinkDialog:!1,isShowShareDialog:!1},r}return(0,l.Z)(t,[{key:"componentDidMount",value:function(){var e=g.Nd.getInstance();this.unsubscribeInternalLinkEvent=e.subscribe(g.dK.INTERNAL_LINK_CLICK,this.onInternalLinkToggle),this.unsubscribeStar=e.subscribe(g.dK.TOGGLE_STAR,this.toggleStar),this.unsubscribeUnmark=e.subscribe(g.dK.UNMARK_AS_DRAFT,this.unmark),this.unsubscribeShare=e.subscribe(g.dK.SHARE_SDOC,this.onShareToggle)}},{key:"componentWillUnmount",value:function(){this.unsubscribeInternalLinkEvent(),this.unsubscribeStar(),this.unsubscribeUnmark(),this.unsubscribeShare()}},{key:"render",value:function(){var e=this.props,n=e.repoID,t=e.docPath,r=e.docName,a=e.docPerm,i=this.state,o=i.isShowInternalLinkDialog,s=i.isShowShareDialog;return(0,b.jsxs)(b.Fragment,{children:[o&&(0,b.jsx)(f.Z,{repoID:n,path:t,onInternalLinkDialogToggle:this.onInternalLinkToggle}),s&&(0,b.jsx)(m.Z,{itemType:"file",itemPath:t,itemName:r,repoID:n,userPerm:a,toggleDialog:this.onShareToggle})]})}}]),t}(r.Component),k=v,D=function(e){(0,d.Z)(t,e);var n=(0,h.Z)(t);function t(e){var r;(0,u.Z)(this,t),(r=n.call(this,e)).toggleStar=function(e){r.setState({isStarred:e})},r.unmarkDraft=function(){r.setState({isDraft:!1})};var a=window.app.pageOptions,i=a.isStarred,o=a.isSdocDraft;return r.state={isStarred:i,isDraft:o},r}return(0,l.Z)(t,[{key:"render",value:function(){var e=window.seafile,n=e.repoID,t=e.docPath,a=e.docName,i=e.docPerm,o=this.state,s=o.isStarred,c=o.isDraft;return(0,b.jsxs)(r.Fragment,{children:[(0,b.jsx)(g.Qo,{isStarred:s,isDraft:c}),(0,b.jsx)(k,{repoID:n,docPath:t,docName:a,docPerm:i,isStarred:s,toggleStar:this.toggleStar,unmarkDraft:this.unmarkDraft})]})}}]),t}(r.Component),I=window.app.config,w=I.serviceURL,L=I.avatarURL,P=I.siteRoot,Z=I.lang,R=window.app.userInfo,U=R.username,N=R.name,T=window.app.pageOptions,j=T.repoID,A=T.repoName,x=T.parentDir,y=T.filePerm,C=T.docPath,E=T.docName,O=T.docUuid,_=T.seadocAccessToken,K=T.seadocServerUrl,F=T.assetsUrl,M=T.isSdocRevision,G=T.isPublished,H=T.originFilename,z=T.revisionCreatedAt;window.seafile={repoID:j,docPath:C,docName:E,docUuid:O,isOpenSocket:!0,serviceUrl:w,accessToken:_,sdocServer:K,name:N,username:U,avatarURL:L,siteRoot:P,docPerm:y,historyURL:s.c.generateHistoryURL(P,j,C),parentFolderURL:"".concat(P,"library/").concat(j,"/").concat(s.c.encodePath(A+x)),assetsUrl:F,isShowInternalLink:!0,isStarIconShown:!0,isSdocRevision:M,isPublished:G,revisionURL:s.c.generateRevisionURL(P,j,C),originFilename:H,revisionCreatedAt:z,lang:Z},a.render((0,b.jsx)(i.a3,{i18n:o.Z,children:(0,b.jsx)(r.Suspense,{fallback:(0,b.jsx)(c.Z,{}),children:(0,b.jsx)(D,{})})}),document.getElementById("wrapper"))}},function(e){e.O(0,[351],(function(){return n=87394,e(e.s=n);var n}));e.O()}]);
//# sourceMappingURL=viewFileSdoc.55300a07.js.map