{"version":3,"file":"static/js/draft.40909971.js","mappings":"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","sources":["utils/seafile-markdown2html.js","components/review-list-view/review-comments.js","components/review-list-view/review-comment-dialog.js","components/dialog/add-reviewer-dialog.js","pages/review/history-list.js","models/review-comment.js","draft.js","../node_modules/unified/index.js"],"sourcesContent":["var unified = require('unified');\nvar markdown = require('remark-parse');\nvar slug = require('remark-slug');\nvar breaks = require('remark-breaks');\nvar remark2rehype = require('remark-rehype');\nvar format = require('rehype-format');\nvar raw = require('rehype-raw');\nvar xtend = require('xtend');\nvar toHTML = require('hast-util-to-html');\nvar sanitize = require('hast-util-sanitize');\nvar gh = require('hast-util-sanitize/lib/github');\nvar deepmerge = require('deepmerge').default;\n\nfunction stringify(config) {\n  var settings = xtend(config, this.data('settings'));\n  var schema = deepmerge(gh, {\n    'attributes': {\n      'input': [\n        'type',\n      ],\n      'li': [\n        'className'\n      ],\n      'code': [\n        'className',\n      ],\n    },\n    'tagNames': [\n      'input',\n      'code'\n    ]\n  });\n  this.Compiler = compiler;\n\n  function compiler(tree) {\n    // use sanity to remove dangerous html, the default is\n    var hast = sanitize(tree, schema);\n    return toHTML(hast, settings);\n  }\n}\n\n// markdown -> mdast -> html AST -> html\nvar processor = unified()\n  .use(markdown, {commonmark: true})\n  .use(breaks)\n  .use(slug)\n  .use(remark2rehype, {allowDangerousHTML: true})\n  .use(raw)\n  .use(format)\n  .use(stringify);\n\nvar processorGetAST = unified()\n  .use(markdown, {commonmark: true})\n  .use(slug);\n\nexport { processor, processorGetAST };\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { processor } from '../../utils/seafile-markdown2html';\nimport { Button, Dropdown, DropdownToggle, DropdownMenu, DropdownItem } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext, draftFilePath, draftRepoID } from '../../utils/constants';\nimport { username } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nimport '../../css/comments-list.css';\n\nconst commentPropTypes = {\n  listComments: PropTypes.func.isRequired,\n  commentsList: PropTypes.array.isRequired,\n  scrollToQuote: PropTypes.func.isRequired\n};\n\nclass ReviewComments extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      showResolvedComment: true,\n      comment: '',\n    };\n  }\n\n  handleCommentChange = (event) => {\n    this.setState({ comment: event.target.value });\n  }\n\n  submitComment = () => {\n    let comment = this.state.comment.trim();\n    if (comment.length > 0) {\n      seafileAPI.postComment(draftRepoID, draftFilePath, comment).then(() => {\n        this.props.listComments();\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n      this.setState({ comment: '' });\n    }\n  }\n\n  resolveComment = (event) => {\n    seafileAPI.updateComment(draftRepoID, event.target.id, 'true').then((res) => {\n      this.props.listComments();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  editComment = (commentID, newComment) => {\n    seafileAPI.updateComment(draftRepoID, commentID, null, null, newComment).then((res) => {\n      this.props.listComments();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  deleteComment = (event) => {\n    seafileAPI.deleteComment(draftRepoID, event.target.id).then((res) => {\n      this.props.listComments();\n    }).catch(error => {\n      let errMessage = Utils.getErrorMsg(error);\n      toaster.danger(errMessage);\n    });\n  }\n\n  scrollToQuote = (newIndex, oldIndex, quote) => {\n    this.props.scrollToQuote(newIndex, oldIndex, quote);\n    this.setState({ comment: '' });\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (this.props.commentsList.length < nextProps.commentsList.length) {\n      let that = this;\n      setTimeout(() => {\n        that.refs.commentsList.scrollTo(0, 10000);\n      }, 100);\n    }\n  }\n\n  render() {\n    const { commentsList } = this.props;\n    return (\n      <div className=\"seafile-comment h-100\">\n        <div className=\"flex-fill o-auto\">\n          {commentsList.length > 0 ? (\n            <ul className=\"seafile-comment-list\" ref='commentsList'>\n              {commentsList.map((item, index) => {\n                return (\n                  <CommentItem\n                    item={item}\n                    key={index}\n                    showResolvedComment={this.state.showResolvedComment}\n                    resolveComment={this.resolveComment}\n                    editComment={this.editComment}\n                    scrollToQuote={this.scrollToQuote}\n                    deleteComment={this.deleteComment}\n                  />\n                );\n              })}\n            </ul>\n          ) :\n            <p className=\"text-center my-4\">{gettext('No comment yet.')}</p>\n          }\n        </div>\n        <div className=\"seafile-comment-footer flex-shrink-0\">\n          <textarea\n            className=\"add-comment-input\"\n            value={this.state.comment}\n            placeholder={gettext('Add a comment...')}\n            onChange={this.handleCommentChange}\n            clos=\"100\" rows=\"3\" warp=\"virtual\"\n          ></textarea>\n          <div className=\"comment-submit-container\">\n            <Button className=\"submit-comment\" color=\"primary\" size=\"sm\" onClick={this.submitComment}>{gettext('Submit')}</Button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nReviewComments.propTypes = commentPropTypes;\n\nconst commentItemPropTypes = {\n  item: PropTypes.object.isRequired,\n  deleteComment: PropTypes.func.isRequired,\n  resolveComment: PropTypes.func.isRequired,\n  editComment: PropTypes.func.isRequired,\n  showResolvedComment: PropTypes.bool.isRequired,\n  scrollToQuote: PropTypes.func.isRequired\n};\n\nclass CommentItem extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      dropdownOpen: false,\n      comment: '',\n      quote: '',\n      newComment: this.props.item.comment,\n      editable: false,\n    };\n  }\n\n  toggleDropDownMenu = () => {\n    this.setState({ dropdownOpen: !this.state.dropdownOpen });\n  }\n\n  convertComment = (item) => {\n    processor.process(item.comment).then((result) => {\n      let comment = String(result);\n      this.setState({ comment: comment });\n    });\n    processor.process(item.quote).then((result) => {\n      let quote = String(result);\n      this.setState({ quote: quote });\n    });\n  }\n\n  scrollToQuote = () => {\n    const item = this.props.item;\n    this.props.scrollToQuote(item.newIndex, item.oldIndex, item.quote);\n  }\n\n  toggleEditComment = () => {\n    this.setState({ editable: !this.state.editable });\n  }\n\n  updateComment = (event) => {\n    const newComment = this.state.newComment;\n    if (this.props.item.comment !== newComment) {\n      this.props.editComment(event.target.id, newComment);\n    }\n    this.toggleEditComment();\n  }\n\n  handleCommentChange = (event) => {\n    this.setState({ newComment: event.target.value });\n  }\n\n  componentWillMount() {\n    this.convertComment(this.props.item);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.convertComment(nextProps.item);\n  }\n\n  render() {\n    const item = this.props.item;\n    if (item.resolved && !this.props.showResolvedComment) return null;\n    if (this.state.editable) {\n      return(\n        <li className=\"seafile-comment-item\" id={item.id}>\n          <div className=\"seafile-comment-info\">\n            <img className=\"avatar\" src={item.avatarUrl} alt=\"\"/>\n            <div className=\"reviewer-info\">\n              <div className=\"reviewer-name ellipsis\">{item.name}</div>\n              <div className=\"review-time\">{item.time}</div>\n            </div>\n          </div>\n          <div className=\"seafile-edit-comment\">\n            <textarea\n              className=\"edit-comment-input\"\n              value={this.state.newComment}\n              onChange={this.handleCommentChange}\n              clos=\"100\" rows=\"3\" warp=\"virtual\"\n            ></textarea>\n            <Button className=\"comment-btn\" color=\"primary\" size=\"sm\" onClick={this.updateComment} id={item.id}>\n              {gettext('Update')}</Button>{' '}\n            <Button className=\"comment-btn\" color=\"secondary\" size=\"sm\" onClick={this.toggleEditComment}>\n              {gettext('Cancel')}</Button>\n          </div>\n        </li>\n      );\n    }\n    return (\n      <li className={item.resolved ? 'seafile-comment-item seafile-comment-item-resolved'\n        : 'seafile-comment-item'} id={item.id}>\n        <div className=\"seafile-comment-info\">\n          <img className=\"avatar\" src={item.avatarUrl} alt=\"\"/>\n          <div className=\"reviewer-info\">\n            <div className=\"reviewer-name ellipsis\">{item.name}</div>\n            <div className=\"review-time\">{item.time}</div>\n          </div>\n          {!item.resolved &&\n            <Dropdown isOpen={this.state.dropdownOpen} size=\"sm\"\n              className=\"seafile-comment-dropdown\" toggle={this.toggleDropDownMenu}>\n              <DropdownToggle className=\"seafile-comment-dropdown-btn\">\n                <i className=\"fas fa-ellipsis-v\"></i>\n              </DropdownToggle>\n              <DropdownMenu>\n                {(item.userEmail === username) &&\n                  <DropdownItem onClick={this.props.deleteComment}\n                    className=\"delete-comment\" id={item.id}>{gettext('Delete')}</DropdownItem>}\n                {(item.userEmail === username) &&\n                  <DropdownItem onClick={this.toggleEditComment}\n                    className=\"edit-comment\" id={item.id}>{gettext('Edit')}</DropdownItem>}\n                <DropdownItem onClick={this.props.resolveComment}\n                  className=\"seafile-comment-resolved\" id={item.id}>{gettext('Mark as resolved')}</DropdownItem>\n              </DropdownMenu>\n            </Dropdown>\n          }\n        </div>\n        {(item.newIndex >= -1 && item.oldIndex >= -1) &&\n          <blockquote className=\"seafile-comment-content\">\n            <div onClick={this.scrollToQuote} dangerouslySetInnerHTML={{ __html: this.state.quote }}></div>\n          </blockquote>\n        }\n        <div className=\"seafile-comment-content\" dangerouslySetInnerHTML={{ __html: this.state.comment }}></div>\n      </li>\n    );\n  }\n}\n\nCommentItem.propTypes = commentItemPropTypes;\n\nexport default ReviewComments;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Button } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext, name, draftRepoID, draftFilePath } from '../../utils/constants';\nimport { processor } from '../../utils/seafile-markdown2html';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\n\nimport '../../css/review-comment-dialog.css';\n\nconst commentDialogPropTypes = {\n  onCommentAdded: PropTypes.func.isRequired,\n  toggleCommentDialog: PropTypes.func.isRequired,\n  quote: PropTypes.string,\n  newIndex: PropTypes.number,\n  oldIndex: PropTypes.number,\n};\n\nclass ReviewCommentDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      comment: '',\n      quote: '',\n    };\n  }\n\n  handleCommentChange = (event) => {\n    let comment = event.target.value;\n    this.setState({ comment: comment });\n  }\n\n  submitComment = () => {\n    const { quote, newIndex, oldIndex } = this.props;\n    const comment = this.state.comment.trim();\n    if (comment.length === 0) return;\n    if (quote.length > 0) {\n      let detail = {\n        quote: quote,\n        newIndex: newIndex,\n        oldIndex: oldIndex\n      };\n      seafileAPI.postComment(draftRepoID, draftFilePath, comment, JSON.stringify(detail)).then(() => {\n        this.props.onCommentAdded();\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    } else {\n      seafileAPI.postComment(draftRepoID, draftFilePath, comment).then(() => {\n        this.props.onCommentAdded();\n      }).catch(error => {\n        let errMessage = Utils.getErrorMsg(error);\n        toaster.danger(errMessage);\n      });\n    }\n    this.setState({ comment: '' });\n  }\n\n  setQuoteText = (mdQuote) => {\n    processor.process(mdQuote).then(\n      (result) => {\n        let quote = String(result);\n        this.setState({ quote: quote });\n      }\n    );\n  }\n\n  componentDidMount() {\n    this.setQuoteText(this.props.quote);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (this.props.quote !== nextProps.quote) {\n      this.setQuoteText(nextProps.quote);\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"review-comment-dialog\">\n        <div>{name}</div>\n        <blockquote className=\"review-comment-dialog-quote\">\n          <div dangerouslySetInnerHTML={{ __html: this.state.quote}}></div>\n        </blockquote>\n        <textarea value={this.state.comment} onChange={this.handleCommentChange}></textarea>\n        <div className=\"button-group\">\n          <Button size=\"sm\" color=\"primary\" onClick={this.submitComment}>{gettext('Submit')}</Button>\n          <Button size=\"sm\" color=\"secondary\" onClick={this.props.toggleCommentDialog}>{gettext('Cancel')}</Button>\n        </div>\n        <span className=\"review-comment-dialog-triangle\"></span>\n      </div>\n    );\n  }\n}\n\nReviewCommentDialog.propTypes = commentDialogPropTypes;\n\nexport default ReviewCommentDialog;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../../utils/constants';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../toast';\nimport UserSelect from '../user-select';\nimport '../../css/add-reviewer-dialog.css';\n\nconst propTypes = {\n  showReviewerDialog: PropTypes.bool.isRequired,\n  draftID: PropTypes.string.isRequired,\n  toggleAddReviewerDialog: PropTypes.func.isRequired,\n  reviewers: PropTypes.array.isRequired\n};\n\nclass AddReviewerDialog extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      reviewers: this.props.reviewers,\n      selectedOption: null,\n      errorMsg: [],\n      loading: false,\n    };\n    this.Options = [];\n  }\n\n  listReviewers = () => {\n    seafileAPI.listDraftReviewers(this.props.draftID).then((res) => {\n      this.setState({ reviewers: res.data.reviewers });\n    });\n  }\n\n  handleSelectChange = (option) => {\n    this.setState({ selectedOption: option });\n    this.Options = [];\n  }\n\n  addReviewers = () => {\n    if (this.state.selectedOption.length > 0 ) {\n      this.refs.reviewSelect.clearSelect();\n      let reviewers = [];\n      for (let i = 0; i < this.state.selectedOption.length; i ++) {\n        reviewers[i] = this.state.selectedOption[i].email;\n      }\n      this.setState({\n        loading: true,\n        errorMsg: [],\n      });\n      seafileAPI.addDraftReviewers(this.props.draftID, reviewers).then((res) => {\n        if (res.data.failed.length > 0) {\n          let errorMsg = [];\n          for (let i = 0 ; i < res.data.failed.length ; i++) {\n            errorMsg[i] = res.data.failed[i];\n          }\n          this.setState({ errorMsg: errorMsg });\n        }\n        this.setState({\n          selectedOption: null,\n          loading: false\n        });\n        if (res.data.success.length > 0) {\n          this.listReviewers();\n        }\n      }).catch(error => {\n        let errorMsg = Utils.getErrorMsg(error);\n        toaster.danger(errorMsg);\n      });\n    }\n  }\n\n  deleteReviewer = (event) => {\n    let reviewer = event.target.getAttribute('name');\n    seafileAPI.deleteDraftReviewer(this.props.draftID, reviewer).then((res) => {\n      if (res.data === 200) {\n        let newReviewers = [];\n        for (let i = 0; i < this.state.reviewers.length; i ++) {\n          if (this.state.reviewers[i].user_email !== reviewer) {\n            newReviewers.push(this.state.reviewers[i]);\n          }\n        }\n        this.setState({ reviewers: newReviewers });\n      }\n    }).catch(error => {\n      let errorMsg = Utils.getErrorMsg(error);\n      toaster.danger(errorMsg);\n    });\n  }\n\n  render() {\n    const toggleDialog = this.props.toggleAddReviewerDialog;\n    const { reviewers, errorMsg } = this.state;\n    return (\n      <Modal isOpen={true} toggle={toggleDialog}>\n        <ModalHeader toggle={toggleDialog}>{gettext('Request a review')}</ModalHeader>\n        <ModalBody>\n          <p>{gettext('Add new reviewer')}</p>\n          <div className='add-reviewer'>\n            <UserSelect\n              placeholder={gettext('Search users...')}\n              onSelectChange={this.handleSelectChange}\n              ref=\"reviewSelect\"\n              isMulti={true}\n              className='reviewer-select'\n            />\n            {(this.state.selectedOption && !this.state.loading)?\n              <Button color=\"secondary\" onClick={this.addReviewers}>{gettext('Submit')}</Button> :\n              <Button color=\"secondary\" disabled>{gettext('Submit')}</Button>\n            }\n          </div>\n          {errorMsg.length > 0 &&\n            errorMsg.map((item, index = 0, arr) => {\n              return (\n                <p className=\"reviewer-select-error error\" key={index}>{errorMsg[index].email}\n                  {': '}{errorMsg[index].error_msg}</p>\n              );\n            })\n          }\n          {reviewers.length > 0 &&\n            reviewers.map((item, index = 0, arr) => {\n              return (\n                <div className=\"reviewer-select-info\" key={index}>\n                  <div className=\"d-flex\">\n                    <img className=\"avatar reviewer-select-avatar\" src={item.avatar_url} alt=\"\"/>\n                    <span className=\"reviewer-select-name ellipsis\">{item.user_name}</span>\n                  </div>\n                  <i className=\"fa fa-times\" name={item.user_email} onClick={this.deleteReviewer}></i>\n                </div>\n              );\n            })\n          }\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"secondary\" onClick={toggleDialog}>{gettext('Close')}</Button>\n        </ModalFooter>\n      </Modal>\n    );\n  }\n}\n\nAddReviewerDialog.propTypes = propTypes;\n\nexport default AddReviewerDialog;\n","/* eslint-disable linebreak-style */\nimport React from 'react';\nimport Loading from '../../components/loading';\nimport moment from 'moment';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { draftRepoID, draftFilePath, draftOriginFilePath } from '../../utils/constants';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\n\nimport '../../css/file-history.css';\n\nmoment.locale(window.app.config.lang);\n\nclass HistoryList extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.perPage = 25;\n    this.state = {\n      currentPage: 1,\n      loading: false\n    };\n  }\n\n  onClick = (event, key, preItem, currentItem)=> {\n    if (key === this.state.activeItem) return false;\n    this.props.onHistoryItemClick(currentItem, preItem, key);\n  }\n\n  onScroll = (event) => {\n    const clientHeight = event.target.clientHeight;\n    const scrollHeight = event.target.scrollHeight;\n    const scrollTop    = event.target.scrollTop;\n    const isBottom = (clientHeight + scrollTop + 1 >= scrollHeight);\n    if (isBottom) {\n      if (this.props.totalReversionCount > this.perPage * this.state.currentPage) {\n        let currentPage = this.state.currentPage + 1;\n        this.setState({\n          currentPage: currentPage,\n          loading : true\n        });\n        seafileAPI.listFileHistoryRecords(draftRepoID, draftFilePath, currentPage, this.perPage).then((res) => {\n          let currentHistoryList = Object.assign([], this.props.historyList);\n          this.props.onHistoryListChange([...currentHistoryList, ...res.data.data]);\n          this.setState({\n            loading : false\n          });\n        }).catch(error => {\n          let errMessage = Utils.getErrorMsg(error);\n          toaster.danger(errMessage);\n        });\n      }\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"history-body\">\n        <ul onScroll={this.onScroll} className={'history-list-container'}>\n          {\n            this.props.historyList ?\n              this.props.historyList.map((item, index = 0, arr) => {\n                let preItemIndex = index + 1;\n                if (preItemIndex === arr.length) {\n                  preItemIndex = index;\n                }\n                return (\n                  <HistoryItem\n                    onClick={this.onClick}\n                    ctime={item.ctime}\n                    className={this.props.activeItem === index ? 'item-active': ''}\n                    name={item.creator_name}\n                    index={index}\n                    key={index}\n                    preItem={arr[preItemIndex]}\n                    currentItem={item}\n                  />\n                );\n              }) : <Loading/>\n          }\n          {\n            this.state.loading &&\n            <li className={'reloading-reversion'}><Loading /></li>\n          }\n        </ul>\n      </div>\n    );\n  }\n}\n\nclass HistoryItem extends React.Component {\n  render() {\n    let time = moment.parseZone(this.props.ctime).format('YYYY-MM-DD HH:mm');\n    return (\n      <li onClick={(event) => this.props.onClick(event, this.props.index, this.props.preItem, this.props.currentItem)} className={'history-list-item ' + this.props.className}>\n        <div className=\"history-info\">\n          <div className=\"time\">{time}</div>\n          <div className=\"owner\"><i className=\"squire-icon\"/><span>{this.props.name}</span></div>\n        </div>\n      </li>\n    );\n  }\n}\n\n\nexport default HistoryList;\n","import moment from 'moment';\n\nclass reviewComment {\n\n  constructor(item) {\n    let oldTime = (new Date(item.created_at)).getTime();\n    this.time = moment(oldTime).format('YYYY-MM-DD HH:mm');\n    this.id = item.id;\n    this.avatarUrl = item.avatar_url;\n    this.comment = item.comment;\n    this.name = item.user_name;\n    this.userEmail = item.user_email;\n    this.resolved = item.resolved;\n    if (item.detail) {\n      let detail = JSON.parse(item.detail);\n      this.newIndex = detail.newIndex;\n      this.oldIndex = detail.oldIndex;\n      this.quote = detail.quote;\n    }\n  }\n\n}\n\nexport default reviewComment;","import React from 'react';\nimport ReactDom from 'react-dom';\nimport PropTypes from 'prop-types';\nimport { Button } from 'reactstrap';\n/* eslint-disable */\nimport Prism from 'prismjs';\n/* eslint-enable */\nimport { ReactEditor, DiffViewer, serialize } from '@seafile/seafile-editor';\nimport { siteRoot, gettext, draftOriginFilePath, draftFilePath, author, authorAvatar, originFileExists, draftFileExists, draftID, draftFileName, draftRepoID, draftStatus, draftPublishVersion, originFileVersion, filePermission, serviceURL, mediaUrl } from './utils/constants';\nimport { seafileAPI } from './utils/seafile-api';\nimport axios from 'axios';\nimport Loading from './components/loading';\nimport ReviewComments from './components/review-list-view/review-comments';\nimport ReviewCommentDialog from './components/review-list-view/review-comment-dialog';\nimport { Tooltip } from 'reactstrap';\nimport AddReviewerDialog from './components/dialog/add-reviewer-dialog';\nimport { Nav, NavItem, NavLink, TabContent, TabPane } from 'reactstrap';\nimport classnames from 'classnames';\nimport HistoryList from './pages/review/history-list';\nimport { Range, Editor } from 'slate';\nimport ModalPortal from './components/modal-portal';\nimport reviewComment from './models/review-comment';\n\nimport './css/layout.css';\nimport './css/toolbar.css';\nimport './css/dirent-detail.css';\nimport './css/draft.css';\n\nconst URL = require('url-parse');\nvar moment = require('moment');\n\nconst { toSlateRange: findRange, toDOMNode } = ReactEditor;\n\nclass Draft extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      draftContent: '',\n      draftOriginContent: '',\n      draftInfo: {},\n      isLoading: true,\n      isShowDiff: true,\n      showDiffTip: false,\n      activeTab: 'reviewInfo',\n      commentsList: [],\n      changedNodes: [],\n      originRepoName: '',\n      isShowCommentDialog: false,\n      activeItem: null,\n      historyList: [],\n      showReviewerDialog: false,\n      reviewers: [],\n      draftStatus: draftStatus,\n    };\n    this.quote = '';\n    this.newIndex = null;\n    this.oldIndex = null;\n    this.changeIndex = -1;\n    this.range = null;\n  }\n\n  initialContent = () => {\n    switch(draftStatus) {\n      case 'open':\n        if (!draftFileExists) {\n          this.setState({\n            isLoading: false,\n            isShowDiff: false\n          });\n          return;\n        }\n\n        if (!originFileExists) {\n          seafileAPI.getFileDownloadLink(draftRepoID, draftFilePath)\n            .then(res => {\n              seafileAPI.getFileContent(res.data)\n                .then(res => {\n                  this.setState({\n                    draftContent: res.data,\n                    draftOriginContent: res.data,\n                    isLoading: false,\n                    isShowDiff: false\n                  });\n                });\n            });\n          return;\n        }\n\n        const hash = window.location.hash;\n        if (hash.indexOf('#history-') === 0) {\n          const currentCommitID = hash.slice(9, 49);\n          const preCommitID = hash.slice(50, 90);\n          let preItemFilePath, currentItemFilePath;\n          this.setState({\n            isLoading: false,\n            activeTab: 'history',\n          });\n          seafileAPI.listFileHistoryRecords(draftRepoID, draftFilePath, 1, 25).then((res) => {\n            const historyList = res.data.data;\n            this.setState({\n              historyList: historyList,\n              totalReversionCount: res.data.total_count\n            });\n            for (let i = 0, length = historyList.length; i < length; i++) {\n              if (preCommitID === historyList[i].commit_id) {\n                this.setState({\n                  activeItem: i\n                });\n                preItemFilePath = historyList[i].path;\n              }\n              if (currentCommitID === historyList[i].commit_id) {\n                currentItemFilePath = historyList[i].path;\n              }\n              if (preItemFilePath && currentItemFilePath) break;\n            }\n            axios.all([\n              seafileAPI.getFileRevision(draftRepoID, currentCommitID, currentItemFilePath),\n              seafileAPI.getFileRevision(draftRepoID, preCommitID, preItemFilePath)\n            ]).then(axios.spread((res1, res2) => {\n              axios.all([seafileAPI.getFileContent(res1.data), seafileAPI.getFileContent(res2.data)]).then(axios.spread((content1, content2) => {\n                this.setDiffViewerContent(content2.data, content1.data);\n              }));\n            }));\n            return;\n          });\n        } else {\n          axios.all([\n            seafileAPI.getFileDownloadLink(draftRepoID, draftFilePath),\n            seafileAPI.getFileDownloadLink(draftRepoID, draftOriginFilePath)\n          ]).then(axios.spread((res1, res2) => {\n            axios.all([\n              seafileAPI.getFileContent(res1.data),\n              seafileAPI.getFileContent(res2.data)\n            ]).then(axios.spread((draftContent, draftOriginContent) => {\n              this.setState({\n                draftContent: draftContent.data,\n                draftOriginContent: draftOriginContent.data,\n                isLoading: false\n              });\n              let that = this;\n              setTimeout(() => {\n                that.getChangedNodes();\n              }, 100);\n            }));\n          }));\n        }\n        break;\n      case 'published':\n        if (!originFileExists) {\n          this.setState({\n            isLoading: false,\n            isShowDiff: false\n          });\n          return;\n        }\n\n        let dl0 = siteRoot + 'repo/' + draftRepoID + '/' + draftPublishVersion + '/download?' + 'p=' + draftOriginFilePath;\n        let dl = siteRoot + 'repo/' + draftRepoID + '/' + originFileVersion + '/download?' + 'p=' + draftOriginFilePath;\n        axios.all([\n          seafileAPI.getFileContent(dl0),\n          seafileAPI.getFileContent(dl)\n        ]).then(axios.spread((draftContent, draftOriginContent) => {\n          this.setState({\n            draftContent: draftContent.data,\n            draftOriginContent: draftOriginContent.data,\n            isLoading: false,\n          });\n        }));\n        break;\n    }\n  }\n\n  onHistoryItemClick = (currentItem, preItem, activeItem) => {\n    const preCommitID = preItem.commit_id;\n    const currentCommitID = currentItem.commit_id;\n    const url = 'history-' + preCommitID + '-' + currentCommitID;\n    this.setURL(url);\n    this.setState({\n      activeItem: activeItem,\n      isLoading: true,\n    });\n    axios.all([\n      seafileAPI.getFileRevision(draftRepoID, currentCommitID, currentItem.path),\n      seafileAPI.getFileRevision(draftRepoID, preCommitID, preItem.path)\n    ]).then(axios.spread((res1, res2) => {\n      axios.all([seafileAPI.getFileContent(res1.data), seafileAPI.getFileContent(res2.data)]).then(axios.spread((content1,content2) => {\n        this.setDiffViewerContent(content1.data, content2.data);\n      }));\n    }));\n  }\n\n  onHistoryListChange = (historyList) => {\n    this.setState({historyList: historyList });\n  }\n\n  listComments = () => {\n    seafileAPI.listComments(draftRepoID, draftFilePath).then((res) => {\n      let commentsList = [];\n      res.data.comments.forEach((item) => {\n        commentsList.push(new reviewComment(item));\n      });\n      this.setState({ commentsList: commentsList });\n    });\n  }\n\n  addComment = (e) => {\n    e.stopPropagation();\n    this.getQuote();\n    if (!this.quote) return;\n    this.setState({ isShowCommentDialog: true });\n  }\n\n  onCommentAdded = () => {\n    this.listComments();\n    this.toggleCommentDialog();\n  }\n\n  toggleCommentDialog = () => {\n    this.setState({\n      isShowCommentDialog: !this.state.isShowCommentDialog\n    });\n  }\n\n  getOriginRepoInfo = () => {\n    seafileAPI.getRepoInfo(draftRepoID).then((res) => {\n      this.setState({ originRepoName: res.data.repo_name });\n    });\n  }\n\n  getDraftInfo = () => {\n    if (draftStatus === 'open') {\n      seafileAPI.getFileInfo(draftRepoID, draftFilePath).then((res) => {\n        this.setState({ draftInfo: res.data });\n      });\n    }\n  }\n\n  getChangedNodes = () => {\n    const nodes = this.refs.diffViewer.value;\n    let keys = [];\n    let lastDiffState = '';\n    nodes.map((node, index) => {\n      const diff_state = node.data['diff_state'];\n      if (diff_state === 'diff-added' && lastDiffState !== 'diff-added') {\n        keys.push(index);\n      } else if (diff_state === 'diff-removed' && lastDiffState !== 'diff-removed') {\n        keys.push(index);\n      } else if (diff_state === 'diff-replaced' && lastDiffState !== 'diff-replaced') {\n        keys.push(index);\n      }\n      lastDiffState = node.data.diff_state;\n    });\n    this.setState({\n      changedNodes: keys\n    });\n  }\n\n  scrollToChangedNode = (scroll) => {\n    if (this.state.changedNodes.length == 0) return;\n    if (scroll === 'up') { this.changeIndex++; } else { this.changeIndex--; }\n    if (this.changeIndex > this.state.changedNodes.length - 1) {\n      this.changeIndex = 0;\n    }\n    if (this.changeIndex < 0) {\n      this.changeIndex = this.state.changedNodes.length - 1;\n    }\n    const win = window;\n    let key = this.state.changedNodes[this.changeIndex];\n    let node = window.viewer.children[key];\n    let element = toDOMNode(window.viewer, node);\n    // fix code-block or tables\n    while (element.className.indexOf('diff-') === -1 && element.tagName !== 'BODY') {\n      element = element.parentNode;\n    }\n    const scroller = this.findScrollContainer(element, win);\n    const isWindow = scroller == win.document.body || scroller == win.document.documentElement;\n    if (isWindow) {\n      win.scrollTo(0, element.offsetTop);\n    } else {\n      scroller.scrollTop = element.offsetTop;\n    }\n  }\n\n  findScrollContainer = (element, window) => {\n    let parent = element.parentNode;\n    const OVERFLOWS = ['auto', 'overlay', 'scroll'];\n    let scroller;\n    while (!scroller) {\n      if (!parent.parentNode) break;\n      const style = window.getComputedStyle(parent);\n      const { overflowY } = style;\n      if (OVERFLOWS.includes(overflowY)) {\n        scroller = parent;\n        break;\n      }\n      parent = parent.parentNode;\n    }\n    if (!scroller) {\n      return window.document.body;\n    }\n    return scroller;\n  }\n\n  scrollToQuote = (newIndex, oldIndex, quote) => {\n    const nodes = this.refs.diffViewer.value;\n    let commentNode = nodes.find((node) => {\n      if (node.data['old_index'] == oldIndex && node.data['new_index'] == newIndex) {\n        return node;\n      }\n    });\n    if (commentNode) {\n      const element = toDOMNode(window.viewer, commentNode);\n      if (!element) return;\n      const win = window;\n      const scroller = this.findScrollContainer(element, win);\n      const isWindow = scroller == win.document.body || scroller == win.document.documentElement;\n      if (isWindow) {\n        win.scrollTo(0, element.offsetTop);\n      } else {\n        scroller.scrollTop = element.offsetTop;\n      }\n    }\n  }\n\n  showDiffViewer = () => {\n    return (\n      <div>\n        {this.state.isShowDiff ?\n          <DiffViewer\n            scriptSource={mediaUrl + 'js/mathjax/tex-svg.js'}\n            newMarkdownContent={this.state.draftContent}\n            oldMarkdownContent={this.state.draftOriginContent}\n            ref=\"diffViewer\"\n          /> :\n          <DiffViewer\n            scriptSource={mediaUrl + 'js/mathjax/tex-svg.js'}\n            newMarkdownContent={this.state.draftContent}\n            oldMarkdownContent={this.state.draftContent}\n            ref=\"diffViewer\"\n          />\n        }\n        <i className=\"fa fa-plus-square review-comment-btn\" ref=\"commentbtn\" onMouseDown={this.addComment}></i>\n      </div>\n    );\n  }\n\n  listReviewers = () => {\n    seafileAPI.listDraftReviewers(draftID).then((res) => {\n      this.setState({\n        reviewers: res.data.reviewers\n      });\n    });\n  }\n\n  onSwitchShowDiff = () => {\n    if (!this.state.isShowDiff) {\n      let that = this;\n      setTimeout(() => {\n        that.getChangedNodes();\n      }, 100);\n    }\n    this.setState({\n      isShowDiff: !this.state.isShowDiff,\n    });\n  }\n\n  toggleDiffTip = () => {\n    this.setState({\n      showDiffTip: !this.state.showDiffTip\n    });\n  }\n\n  toggleAddReviewerDialog = () => {\n    if (this.state.showReviewerDialog) {\n      this.listReviewers();\n    }\n    this.setState({\n      showReviewerDialog: !this.state.showReviewerDialog\n    });\n  }\n\n  showDiffButton = () => {\n    return (\n      <div className={'seafile-toggle-diff'}>\n        <label className=\"custom-switch\" id=\"toggle-diff\">\n          <input type=\"checkbox\" checked={this.state.isShowDiff && 'checked'}\n            name=\"option\" className=\"custom-switch-input\"\n            onChange={this.onSwitchShowDiff}/>\n          <span className=\"custom-switch-indicator\"></span>\n        </label>\n        <Tooltip placement=\"bottom\" isOpen={this.state.showDiffTip}\n          target=\"toggle-diff\" toggle={this.toggleDiffTip}>\n          {gettext('View diff')}</Tooltip>\n      </div>\n    );\n  }\n\n  onPublishDraft = () => {\n    seafileAPI.publishDraft(draftID).then(res => {\n      this.setState({\n        draftStatus: res.data.draft_status,\n      });\n    });\n  }\n\n  initialDiffViewerContent = () => {\n    seafileAPI.listFileHistoryRecords(draftRepoID, draftFilePath, 1, 25).then((res) => {\n      this.setState({\n        historyList: res.data.data,\n        totalReversionCount: res.data.total_count\n      });\n      if (res.data.data.length > 1) {\n        axios.all([\n          seafileAPI.getFileRevision(draftRepoID, res.data.data[0].commit_id, draftFilePath),\n          seafileAPI.getFileRevision(draftRepoID, res.data.data[1].commit_id, draftFilePath)\n        ]).then(axios.spread((res1, res2) => {\n          axios.all([seafileAPI.getFileContent(res1.data), seafileAPI.getFileContent(res2.data)]).then(axios.spread((content1,content2) => {\n            this.setState({\n              draftContent: content1.data,\n              draftOriginContent: content2.data\n            });\n          }));\n        }));\n      } else {\n        seafileAPI.getFileRevision(draftRepoID, res.data.data[0].commit_id, draftFilePath).then((res) => {\n          seafileAPI.getFileContent(res.data).then((content) => {\n            this.setState({\n              draftContent: content.data,\n              draftOriginContent: ''\n            });\n          });\n        });\n      }\n    });\n  }\n\n  setDiffViewerContent = (newContent, prevContent) => {\n    this.setState({\n      draftContent: newContent,\n      draftOriginContent: prevContent,\n      isLoading: false,\n    });\n  }\n\n  setURL = (newurl) => {\n    let url = new URL(window.location.href);\n    url.set('hash', newurl);\n    window.location.href = url.toString();\n  }\n\n  tabItemClick = (tab) => {\n    if (this.state.activeTab !== tab) {\n      if (tab !== 'history' && window.location.hash) {\n        this.setURL('#');\n      }\n      if (tab == 'reviewInfo') {\n        this.initialContent();\n      } else if (tab == 'history') {\n        this.initialDiffViewerContent();\n      }\n      this.setState({\n        activeTab: tab\n      });\n    }\n  }\n\n  showNavItem = (showTab) => {\n    const commentsNumber = this.state.commentsList.length;\n    switch(showTab) {\n      case 'info':\n        return (\n          <NavItem className=\"nav-item\">\n            <NavLink\n              className={classnames({ active: this.state.activeTab === 'reviewInfo' })}\n              onClick={() => { this.tabItemClick('reviewInfo');}}\n            >\n              <i className=\"fas fa-info-circle\"></i>\n            </NavLink>\n          </NavItem>\n        );\n      case 'comments':\n        return (\n          <NavItem className=\"nav-item\">\n            <NavLink\n              className={classnames({ active: this.state.activeTab === 'comments' })}\n              onClick={() => {this.tabItemClick('comments');}}\n            >\n              <i className=\"fa fa-comments\"></i>\n              {commentsNumber > 0 && <div className='comments-number'>{commentsNumber}</div>}\n            </NavLink>\n          </NavItem>\n        );\n      case 'history':\n        return (\n          <NavItem className=\"nav-item\">\n            <NavLink\n              className={classnames({ active: this.state.activeTab === 'history' })}\n              onClick={() => { this.tabItemClick('history');}}\n            >\n              <i className=\"fas fa-history\"></i>\n            </NavLink>\n          </NavItem>\n        );\n    }\n  }\n\n  getDomNodeByPath = (path) => {\n    let node, parent = document.querySelector('.viewer-component');\n    while(typeof path[0] === 'number' && parent) {\n      node = parent.children[path[0]];\n      if (!node.getAttribute('data-slate-node')) {\n        node = node.children[0];\n      }\n      path.shift();\n      parent = node;\n    }\n    return node;\n  }\n\n  setBtnPosition = () => {\n    const nativeSelection = window.getSelection();\n    if (!nativeSelection.rangeCount) {\n      return;\n    }\n    const nativeRange = nativeSelection.getRangeAt(0);\n    let selection = null;\n    let style = this.refs.commentbtn.style;\n    try {\n      selection = findRange(window.viewer, nativeRange);\n    } catch (err) {\n      style.top = '-1000px';\n      return;\n    }\n    if (!selection || Range.isCollapsed(selection)) {\n      style.top = '-1000px';\n      return;\n    }\n    this.range = selection;\n    const focusNodePath = selection.anchor.path.slice();\n    focusNodePath.pop();\n    const focusNode = this.getDomNodeByPath(focusNodePath);\n    style.right = '0px';\n\n    if (focusNode) {\n      style.top = `${focusNode.offsetTop}px`;\n    } else {\n      style.top = '-1000px';\n    }\n  }\n\n  getQuote = () => {\n    if (!this.range) return;\n    this.quote = serialize(Editor.fragment(window.viewer, this.range));\n    const node = window.viewer.children[this.range.anchor.path[0]];\n    this.newIndex = node.data['new_index'];\n    this.oldIndex = node.data['old_index'];\n  }\n\n  componentDidMount() {\n    this.getOriginRepoInfo();\n    this.getDraftInfo();\n    this.listReviewers();\n    this.listComments();\n    this.initialContent();\n    document.addEventListener('selectionchange', this.setBtnPosition);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('selectionchange', this.setBtnPosition);\n  }\n\n  renderDiffButton = () => {\n    switch(draftStatus) {\n      case 'open':\n        if (!draftFileExists || !originFileExists) {\n          return;\n        }\n        return this.showDiffButton();\n      case 'published':\n        if (!originFileExists) {\n          return;\n        }\n        return this.showDiffButton();\n    }\n  }\n\n  renderNavItems = () => {\n    switch (draftStatus) {\n      case 'open':\n        if (!draftFileExists) {\n          return (\n            <Nav tabs className=\"review-side-panel-nav\">\n              {this.showNavItem('info')}\n            </Nav>\n          );\n        }\n\n        return (\n          <Nav tabs className=\"review-side-panel-nav\">\n            {this.showNavItem('info')}\n            {this.showNavItem('comments')}\n            {this.showNavItem('history')}\n          </Nav>\n        );\n      case 'published':\n        if (!originFileExists) {\n          return (\n            <Nav tabs className=\"review-side-panel-nav\">\n              {this.showNavItem('info')}\n            </Nav>\n          );\n        }\n        return (\n          <Nav tabs className=\"review-side-panel-nav\">\n            {this.showNavItem('info')}\n            {this.showNavItem('comments')}\n          </Nav>\n        );\n    }\n  }\n\n  renderContent = () => {\n    switch(draftStatus) {\n      case 'open':\n        if (!draftFileExists) {\n          return <p className=\"error\">{gettext('Draft has been deleted.')}</p>;\n        }\n        return this.showDiffViewer();\n      case 'published':\n        if (!originFileExists) {\n          return <p className=\"error\">{gettext('Original file has been deleted.')}</p>;\n        }\n        return this.showDiffViewer();\n    }\n  }\n\n  render() {\n    const { draftInfo, reviewers, originRepoName, draftStatus } = this.state;\n    const draftLink = siteRoot + 'lib/' + draftRepoID + '/file' + draftFilePath + '?mode=edit';\n    const showPublishedButton = this.state.draftStatus == 'published';\n    const showPublishButton = this.state.draftStatus == 'open' && filePermission == 'rw';\n    const showEditButton = this.state.draftStatus == 'open' && filePermission == 'rw';\n    const time = moment(draftInfo.mtime * 1000).format('YYYY-MM-DD HH:mm');\n    const url = `${siteRoot}profile/${encodeURIComponent(draftInfo.last_modifier_email)}/`;\n    return(\n      <div className=\"wrapper\">\n        <div id=\"header\" className=\"header review\">\n          <div className=\"cur-file-info\">\n            <div className=\"info-item file-feature\">\n              <span className=\"sf2-icon-review\"></span>\n            </div>\n            <div>\n              <div className=\"info-item file-info\">\n                <span className=\"file-name\">{draftFileName}</span>\n                <span className=\"mx-2 file-review\">{gettext('Review')}</span>\n              </div>\n              {(!showPublishedButton && draftInfo.mtime) &&\n                <div className=\"last-modification\">\n                  <a href={url}>{draftInfo.last_modifier_name}</a><span className=\"mx-1\">{time}</span>\n                </div>\n              }\n            </div>\n          </div>\n          <div className=\"button-group\">\n            {this.renderDiffButton()}\n            {showEditButton &&\n              <a href={draftLink} className=\"mx-1\">\n                <Button className=\"file-operation-btn\" color=\"secondary\">{gettext('Edit Draft')}</Button>\n              </a>\n            }\n            {showPublishButton &&\n              <button className='btn btn-success file-operation-btn' title={gettext('Publish draft')} onClick={this.onPublishDraft}>\n                {gettext('Publish')}\n              </button>\n            }\n            {showPublishedButton &&\n              <button className='btn btn-success file-operation-btn' title={gettext('Published')} disabled>\n                {gettext('Published')}\n              </button>\n            }\n          </div>\n        </div>\n        <div id=\"main\" className=\"main\" ref=\"main\">\n          <div className=\"cur-view-container\">\n            <div className='cur-view-content' ref=\"viewContent\">\n              {this.state.isLoading ?\n                <div className=\"markdown-viewer-render-content article\">\n                  <Loading />\n                </div>\n                :\n                <div className=\"markdown-viewer-render-content article\">\n                  {this.renderContent()}\n                </div>\n              }\n            </div>\n            <div className=\"cur-view-right-part\">\n              <div className=\"review-side-panel\">\n                {this.renderNavItems()}\n                <TabContent activeTab={this.state.activeTab}>\n                  <TabPane tabId=\"reviewInfo\">\n                    <div className=\"review-side-panel-body\">\n                      <SidePanelReviewers\n                        reviewers={reviewers}\n                        toggleAddReviewerDialog={this.toggleAddReviewerDialog}/>\n                      <SidePanelAuthor/>\n                      {draftFileExists && <UnresolvedComments commentsList={this.state.commentsList}/>}\n                      {(this.state.isShowDiff === true && this.state.changedNodes.length > 0) &&\n                      <SidePanelChanges\n                        changedNumber={this.state.changedNodes.length}\n                        scrollToChangedNode={this.scrollToChangedNode}/>\n                      }\n                      <SidePanelOrigin originRepoName={originRepoName} draftInfo={draftInfo} draftStatus={draftStatus}/>\n                    </div>\n                  </TabPane>\n                  <TabPane tabId=\"comments\" className=\"comments\">\n                    <ReviewComments\n                      scrollToQuote={this.scrollToQuote}\n                      listComments={this.listComments}\n                      commentsList={this.state.commentsList}\n                      inResizing={false}\n                    />\n                  </TabPane>\n                  <TabPane tabId=\"history\" className=\"history\">\n                    <HistoryList\n                      activeItem={this.state.activeItem}\n                      historyList={this.state.historyList}\n                      totalReversionCount={this.state.totalReversionCount}\n                      onHistoryItemClick={this.onHistoryItemClick}\n                      onHistoryListChange={this.onHistoryListChange}\n                    />\n                  </TabPane>\n                </TabContent>\n              </div>\n            </div>\n          </div>\n        </div>\n        {this.state.showReviewerDialog &&\n          <ModalPortal>\n            <AddReviewerDialog\n              showReviewerDialog={this.state.showReviewerDialog}\n              toggleAddReviewerDialog={this.toggleAddReviewerDialog}\n              draftID={draftID}\n              reviewers={reviewers}\n            />\n          </ModalPortal>\n        }\n        {this.state.isShowCommentDialog &&\n          <ModalPortal>\n            <ReviewCommentDialog\n              toggleCommentDialog={this.toggleCommentDialog}\n              onCommentAdded={this.onCommentAdded}\n              quote={this.quote}\n              newIndex={this.newIndex}\n              oldIndex={this.oldIndex}\n            />\n          </ModalPortal>\n        }\n      </div>\n    );\n  }\n}\n\n\nclass SidePanelReviewers extends React.Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    const { reviewers } = this.props;\n    return (\n      <div className=\"review-side-panel-item\">\n        <div className=\"review-side-panel-header\">{gettext('Reviewers')}\n          <i className=\"fa fa-cog\" onClick={this.props.toggleAddReviewerDialog}></i>\n        </div>\n        {reviewers.length > 0 ?\n          reviewers.map((item, index = 0, arr) => {\n            return (\n              <div className=\"reviewer-info\" key={index}>\n                <img className=\"avatar review-side-panel-avatar\" src={item.avatar_url} alt=\"\"/>\n                <span className=\"reviewer-name ellipsis\">{item.user_name}</span>\n              </div>\n            );\n          })\n          :\n          <span>{gettext('No reviewer yet.')}</span>\n        }\n      </div>\n    );\n  }\n}\n\nconst sidePanelReviewersPropTypes = {\n  reviewers: PropTypes.array.isRequired,\n  toggleAddReviewerDialog: PropTypes.func.isRequired\n};\n\nSidePanelReviewers.propTypes = sidePanelReviewersPropTypes;\n\nclass SidePanelAuthor extends React.Component {\n  render() {\n    return (\n      <div className=\"review-side-panel-item\">\n        <div className=\"review-side-panel-header\">{gettext('Author')}</div>\n        <div className=\"author-info\">\n          <img className=\"avatar review-side-panel-avatar\" src={authorAvatar} alt=\"\"/>\n          <span className=\"author-name ellipsis\">{author}</span>\n        </div>\n      </div>\n    );\n  }\n}\n\nclass SidePanelOrigin extends React.Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    const { draftStatus, originRepoName } = this.props;\n    const filePath = serviceURL + '/lib/' + draftRepoID + '/file' + draftOriginFilePath;\n    return (\n      <div className=\"dirent-table-container\">\n        <table className=\"table-thead-hidden\">\n          <thead>\n            <tr><th width=\"25%\"></th><th width=\"75%\"></th></tr>\n          </thead>\n          <tbody>\n            <tr>\n              <th className=\"align-text-top\">{gettext('Location')}</th>\n              <td>\n                {draftStatus === 'open' ?\n                  <span>{originRepoName}{draftFilePath}</span> :\n                  <a href={filePath} className=\"text-dark\">{filePath}</a>\n                }\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    );\n  }\n}\n\nconst SidePanelOriginPropTypes = {\n  originRepoName: PropTypes.string.isRequired,\n  draftStatus: PropTypes.string.isRequired,\n};\n\nSidePanelOrigin.propTypes = SidePanelOriginPropTypes;\n\n\nclass UnresolvedComments extends React.Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    const { commentsList } = this.props;\n    let unresolvedNumber = 0;\n    if (commentsList) {\n      for (let i = 0, count = commentsList.length; i < count; i++) {\n        if (commentsList[i].resolved === false) {\n          unresolvedNumber++;\n        }\n      }\n    }\n    return (\n      <div className=\"review-side-panel-item\">\n        <div className=\"review-side-panel-header\">{gettext('Comments')}</div>\n        <div className=\"changes-info\">\n          <span>{gettext('Unresolved comments:')}{' '}{unresolvedNumber}</span>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst UnresolvedCommentsPropTypes = {\n  commentsList: PropTypes.array.isRequired,\n};\n\nUnresolvedComments.propTypes = UnresolvedCommentsPropTypes;\n\n\nclass SidePanelChanges extends React.Component {\n\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    return (\n      <div className=\"review-side-panel-item\">\n        <div className=\"review-side-panel-header\">{gettext('Changes')}</div>\n        <div className=\"changes-info\">\n          <span>{gettext('Number of changes:')}{' '}{this.props.changedNumber}</span>\n          {this.props.changedNumber > 0 &&\n            <div>\n              <i className=\"fa fa-arrow-circle-up\" onClick={() => { this.props.scrollToChangedNode('down');}}></i>\n              <i className=\"fa fa-arrow-circle-down\" onClick={() => { this.props.scrollToChangedNode('up');}}></i>\n            </div>\n          }\n        </div>\n      </div>\n    );\n  }\n}\n\nconst sidePanelChangesPropTypes = {\n  changedNumber: PropTypes.number.isRequired,\n  scrollToChangedNode: PropTypes.func.isRequired\n};\n\nSidePanelChanges.propTypes = sidePanelChangesPropTypes;\n\n\nReactDom.render(<Draft />, document.getElementById('wrapper'));\n","'use strict'\n\nvar extend = require('extend')\nvar bail = require('bail')\nvar vfile = require('vfile')\nvar trough = require('trough')\nvar string = require('x-is-string')\nvar plain = require('is-plain-obj')\n\n// Expose a frozen processor.\nmodule.exports = unified().freeze()\n\nvar slice = [].slice\nvar own = {}.hasOwnProperty\n\n// Process pipeline.\nvar pipeline = trough()\n  .use(pipelineParse)\n  .use(pipelineRun)\n  .use(pipelineStringify)\n\nfunction pipelineParse(p, ctx) {\n  ctx.tree = p.parse(ctx.file)\n}\n\nfunction pipelineRun(p, ctx, next) {\n  p.run(ctx.tree, ctx.file, done)\n\n  function done(err, tree, file) {\n    if (err) {\n      next(err)\n    } else {\n      ctx.tree = tree\n      ctx.file = file\n      next()\n    }\n  }\n}\n\nfunction pipelineStringify(p, ctx) {\n  ctx.file.contents = p.stringify(ctx.tree, ctx.file)\n}\n\n// Function to create the first processor.\nfunction unified() {\n  var attachers = []\n  var transformers = trough()\n  var namespace = {}\n  var frozen = false\n  var freezeIndex = -1\n\n  // Data management.\n  processor.data = data\n\n  // Lock.\n  processor.freeze = freeze\n\n  // Plugins.\n  processor.attachers = attachers\n  processor.use = use\n\n  // API.\n  processor.parse = parse\n  processor.stringify = stringify\n  processor.run = run\n  processor.runSync = runSync\n  processor.process = process\n  processor.processSync = processSync\n\n  // Expose.\n  return processor\n\n  // Create a new processor based on the processor in the current scope.\n  function processor() {\n    var destination = unified()\n    var length = attachers.length\n    var index = -1\n\n    while (++index < length) {\n      destination.use.apply(null, attachers[index])\n    }\n\n    destination.data(extend(true, {}, namespace))\n\n    return destination\n  }\n\n  // Freeze: used to signal a processor that has finished configuration.\n  //\n  // For example, take unified itself.  It’s frozen.  Plugins should not be\n  // added to it.  Rather, it should be extended, by invoking it, before\n  // modifying it.\n  //\n  // In essence, always invoke this when exporting a processor.\n  function freeze() {\n    var values\n    var plugin\n    var options\n    var transformer\n\n    if (frozen) {\n      return processor\n    }\n\n    while (++freezeIndex < attachers.length) {\n      values = attachers[freezeIndex]\n      plugin = values[0]\n      options = values[1]\n      transformer = null\n\n      if (options === false) {\n        continue\n      }\n\n      if (options === true) {\n        values[1] = undefined\n      }\n\n      transformer = plugin.apply(processor, values.slice(1))\n\n      if (typeof transformer === 'function') {\n        transformers.use(transformer)\n      }\n    }\n\n    frozen = true\n    freezeIndex = Infinity\n\n    return processor\n  }\n\n  // Data management.  Getter / setter for processor-specific informtion.\n  function data(key, value) {\n    if (string(key)) {\n      // Set `key`.\n      if (arguments.length === 2) {\n        assertUnfrozen('data', frozen)\n\n        namespace[key] = value\n\n        return processor\n      }\n\n      // Get `key`.\n      return (own.call(namespace, key) && namespace[key]) || null\n    }\n\n    // Set space.\n    if (key) {\n      assertUnfrozen('data', frozen)\n      namespace = key\n      return processor\n    }\n\n    // Get space.\n    return namespace\n  }\n\n  // Plugin management.\n  //\n  // Pass it:\n  // *   an attacher and options,\n  // *   a preset,\n  // *   a list of presets, attachers, and arguments (list of attachers and\n  //     options).\n  function use(value) {\n    var settings\n\n    assertUnfrozen('use', frozen)\n\n    if (value === null || value === undefined) {\n      // Empty.\n    } else if (typeof value === 'function') {\n      addPlugin.apply(null, arguments)\n    } else if (typeof value === 'object') {\n      if ('length' in value) {\n        addList(value)\n      } else {\n        addPreset(value)\n      }\n    } else {\n      throw new Error('Expected usable value, not `' + value + '`')\n    }\n\n    if (settings) {\n      namespace.settings = extend(namespace.settings || {}, settings)\n    }\n\n    return processor\n\n    function addPreset(result) {\n      addList(result.plugins)\n\n      if (result.settings) {\n        settings = extend(settings || {}, result.settings)\n      }\n    }\n\n    function add(value) {\n      if (typeof value === 'function') {\n        addPlugin(value)\n      } else if (typeof value === 'object') {\n        if ('length' in value) {\n          addPlugin.apply(null, value)\n        } else {\n          addPreset(value)\n        }\n      } else {\n        throw new Error('Expected usable value, not `' + value + '`')\n      }\n    }\n\n    function addList(plugins) {\n      var length\n      var index\n\n      if (plugins === null || plugins === undefined) {\n        // Empty.\n      } else if (typeof plugins === 'object' && 'length' in plugins) {\n        length = plugins.length\n        index = -1\n\n        while (++index < length) {\n          add(plugins[index])\n        }\n      } else {\n        throw new Error('Expected a list of plugins, not `' + plugins + '`')\n      }\n    }\n\n    function addPlugin(plugin, value) {\n      var entry = find(plugin)\n\n      if (entry) {\n        if (plain(entry[1]) && plain(value)) {\n          value = extend(entry[1], value)\n        }\n\n        entry[1] = value\n      } else {\n        attachers.push(slice.call(arguments))\n      }\n    }\n  }\n\n  function find(plugin) {\n    var length = attachers.length\n    var index = -1\n    var entry\n\n    while (++index < length) {\n      entry = attachers[index]\n\n      if (entry[0] === plugin) {\n        return entry\n      }\n    }\n  }\n\n  // Parse a file (in string or vfile representation) into a unist node using\n  // the `Parser` on the processor.\n  function parse(doc) {\n    var file = vfile(doc)\n    var Parser\n\n    freeze()\n    Parser = processor.Parser\n    assertParser('parse', Parser)\n\n    if (newable(Parser)) {\n      return new Parser(String(file), file).parse()\n    }\n\n    return Parser(String(file), file) // eslint-disable-line new-cap\n  }\n\n  // Run transforms on a unist node representation of a file (in string or\n  // vfile representation), async.\n  function run(node, file, cb) {\n    assertNode(node)\n    freeze()\n\n    if (!cb && typeof file === 'function') {\n      cb = file\n      file = null\n    }\n\n    if (!cb) {\n      return new Promise(executor)\n    }\n\n    executor(null, cb)\n\n    function executor(resolve, reject) {\n      transformers.run(node, vfile(file), done)\n\n      function done(err, tree, file) {\n        tree = tree || node\n        if (err) {\n          reject(err)\n        } else if (resolve) {\n          resolve(tree)\n        } else {\n          cb(null, tree, file)\n        }\n      }\n    }\n  }\n\n  // Run transforms on a unist node representation of a file (in string or\n  // vfile representation), sync.\n  function runSync(node, file) {\n    var complete = false\n    var result\n\n    run(node, file, done)\n\n    assertDone('runSync', 'run', complete)\n\n    return result\n\n    function done(err, tree) {\n      complete = true\n      bail(err)\n      result = tree\n    }\n  }\n\n  // Stringify a unist node representation of a file (in string or vfile\n  // representation) into a string using the `Compiler` on the processor.\n  function stringify(node, doc) {\n    var file = vfile(doc)\n    var Compiler\n\n    freeze()\n    Compiler = processor.Compiler\n    assertCompiler('stringify', Compiler)\n    assertNode(node)\n\n    if (newable(Compiler)) {\n      return new Compiler(node, file).compile()\n    }\n\n    return Compiler(node, file) // eslint-disable-line new-cap\n  }\n\n  // Parse a file (in string or vfile representation) into a unist node using\n  // the `Parser` on the processor, then run transforms on that node, and\n  // compile the resulting node using the `Compiler` on the processor, and\n  // store that result on the vfile.\n  function process(doc, cb) {\n    freeze()\n    assertParser('process', processor.Parser)\n    assertCompiler('process', processor.Compiler)\n\n    if (!cb) {\n      return new Promise(executor)\n    }\n\n    executor(null, cb)\n\n    function executor(resolve, reject) {\n      var file = vfile(doc)\n\n      pipeline.run(processor, {file: file}, done)\n\n      function done(err) {\n        if (err) {\n          reject(err)\n        } else if (resolve) {\n          resolve(file)\n        } else {\n          cb(null, file)\n        }\n      }\n    }\n  }\n\n  // Process the given document (in string or vfile representation), sync.\n  function processSync(doc) {\n    var complete = false\n    var file\n\n    freeze()\n    assertParser('processSync', processor.Parser)\n    assertCompiler('processSync', processor.Compiler)\n    file = vfile(doc)\n\n    process(file, done)\n\n    assertDone('processSync', 'process', complete)\n\n    return file\n\n    function done(err) {\n      complete = true\n      bail(err)\n    }\n  }\n}\n\n// Check if `func` is a constructor.\nfunction newable(value) {\n  return typeof value === 'function' && keys(value.prototype)\n}\n\n// Check if `value` is an object with keys.\nfunction keys(value) {\n  var key\n  for (key in value) {\n    return true\n  }\n  return false\n}\n\n// Assert a parser is available.\nfunction assertParser(name, Parser) {\n  if (typeof Parser !== 'function') {\n    throw new Error('Cannot `' + name + '` without `Parser`')\n  }\n}\n\n// Assert a compiler is available.\nfunction assertCompiler(name, Compiler) {\n  if (typeof Compiler !== 'function') {\n    throw new Error('Cannot `' + name + '` without `Compiler`')\n  }\n}\n\n// Assert the processor is not frozen.\nfunction assertUnfrozen(name, frozen) {\n  if (frozen) {\n    throw new Error(\n      'Cannot invoke `' +\n        name +\n        '` on a frozen processor.\\nCreate a new processor first, by invoking it: use `processor()` instead of `processor`.'\n    )\n  }\n}\n\n// Assert `node` is a unist node.\nfunction assertNode(node) {\n  if (!node || !string(node.type)) {\n    throw new Error('Expected node, got `' + node + '`')\n  }\n}\n\n// Assert that `complete` is `true`.\nfunction assertDone(name, asyncName, complete) {\n  if (!complete) {\n    throw new Error(\n      '`' + name + '` finished async. Use `' + asyncName + '` instead'\n    )\n  }\n}\n"],"names":["unified","require","markdown","slug","breaks","remark2rehype","format","raw","xtend","toHTML","sanitize","gh","deepmerge","processor","use","commonmark","allowDangerousHTML","config","settings","this","data","schema","Compiler","tree","hast","ReviewComments","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","handleCommentChange","event","setState","comment","target","value","submitComment","state","trim","length","seafileAPI","postComment","draftRepoID","draftFilePath","then","listComments","catch","error","errMessage","Utils","getErrorMsg","toaster","danger","resolveComment","updateComment","id","res","editComment","commentID","newComment","deleteComment","scrollToQuote","newIndex","oldIndex","quote","showResolvedComment","_createClass","key","nextProps","commentsList","that","setTimeout","refs","scrollTo","_this2","_jsxs","className","children","_jsx","ref","map","item","index","CommentItem","gettext","placeholder","onChange","clos","rows","warp","Button","color","size","onClick","React","_React$Component2","_super2","_this3","toggleDropDownMenu","dropdownOpen","convertComment","process","result","String","toggleEditComment","editable","resolved","src","avatarUrl","alt","name","time","Dropdown","isOpen","toggle","DropdownToggle","DropdownMenu","userEmail","username","DropdownItem","dangerouslySetInnerHTML","__html","ReviewCommentDialog","_this$props","detail","JSON","stringify","onCommentAdded","setQuoteText","mdQuote","toggleCommentDialog","AddReviewerDialog","listReviewers","listDraftReviewers","draftID","reviewers","handleSelectChange","option","selectedOption","Options","addReviewers","reviewSelect","clearSelect","i","email","loading","errorMsg","addDraftReviewers","failed","success","deleteReviewer","reviewer","getAttribute","deleteDraftReviewer","newReviewers","user_email","push","toggleDialog","toggleAddReviewerDialog","_this$state","Modal","ModalHeader","ModalBody","UserSelect","onSelectChange","isMulti","disabled","arguments","undefined","error_msg","avatar_url","user_name","ModalFooter","moment","window","app","lang","HistoryList","preItem","currentItem","activeItem","onHistoryItemClick","onScroll","clientHeight","scrollHeight","scrollTop","totalReversionCount","perPage","currentPage","listFileHistoryRecords","currentHistoryList","Object","assign","historyList","onHistoryListChange","concat","_toConsumableArray","arr","preItemIndex","HistoryItem","ctime","creator_name","Loading","apply","reviewComment","oldTime","Date","created_at","getTime","parse","URL","findRange","ReactEditor","toSlateRange","toDOMNode","Draft","initialContent","draftStatus","draftFileExists","isLoading","isShowDiff","originFileExists","getFileDownloadLink","getFileContent","draftContent","draftOriginContent","hash","location","indexOf","preItemFilePath","currentItemFilePath","currentCommitID","slice","preCommitID","activeTab","total_count","commit_id","path","axios","all","getFileRevision","spread","res1","res2","content1","content2","setDiffViewerContent","draftOriginFilePath","_assertThisInitialized","getChangedNodes","dl0","siteRoot","draftPublishVersion","dl","originFileVersion","url","setURL","comments","forEach","addComment","e","stopPropagation","getQuote","isShowCommentDialog","getOriginRepoInfo","getRepoInfo","originRepoName","repo_name","getDraftInfo","getFileInfo","draftInfo","nodes","diffViewer","keys","lastDiffState","node","diff_state","changedNodes","scrollToChangedNode","scroll","changeIndex","win","viewer","element","tagName","parentNode","scroller","findScrollContainer","document","body","documentElement","offsetTop","parent","OVERFLOWS","overflowY","getComputedStyle","includes","commentNode","find","showDiffViewer","DiffViewer","scriptSource","mediaUrl","newMarkdownContent","oldMarkdownContent","onMouseDown","onSwitchShowDiff","toggleDiffTip","showDiffTip","showReviewerDialog","showDiffButton","type","checked","Tooltip","placement","onPublishDraft","publishDraft","draft_status","initialDiffViewerContent","content","newContent","prevContent","newurl","href","set","toString","tabItemClick","tab","showNavItem","showTab","commentsNumber","NavItem","NavLink","classnames","active","getDomNodeByPath","querySelector","shift","setBtnPosition","nativeSelection","getSelection","rangeCount","nativeRange","getRangeAt","selection","style","commentbtn","err","top","Range","isCollapsed","range","focusNodePath","anchor","pop","focusNode","right","serialize","Editor","fragment","renderDiffButton","renderNavItems","Nav","tabs","renderContent","addEventListener","removeEventListener","draftLink","showPublishedButton","showPublishButton","filePermission","showEditButton","mtime","encodeURIComponent","last_modifier_email","draftFileName","last_modifier_name","title","TabContent","TabPane","tabId","SidePanelReviewers","SidePanelAuthor","UnresolvedComments","SidePanelChanges","changedNumber","SidePanelOrigin","inResizing","ModalPortal","_React$Component3","_super3","authorAvatar","author","_React$Component4","_super4","filePath","serviceURL","width","_React$Component5","_super5","unresolvedNumber","count","_React$Component6","_super6","ReactDom","getElementById","extend","bail","vfile","trough","string","plain","module","exports","attachers","transformers","namespace","frozen","freezeIndex","assertUnfrozen","own","freeze","addPlugin","Error","addList","addPreset","plugins","add","plugin","entry","doc","Parser","file","assertParser","newable","assertCompiler","assertNode","compile","run","runSync","complete","done","assertDone","processSync","destination","values","options","transformer","Infinity","cb","Promise","executor","resolve","reject","pipeline","hasOwnProperty","p","ctx","next","contents","prototype","asyncName"],"sourceRoot":""}