{"version":3,"file":"static/js/sdocFileHistory.76834263.js","mappings":"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","sources":["components/common/go-back/index.js","components/rename.js","pages/sdoc-file-history/history-version.js","components/common/switch/index.js","pages/sdoc-file-history/side-panel.js","pages/sdoc-file-history/index.js"],"sourcesContent":["import React, { Component } from 'react';\n\nimport './index.css';\n\nclass GoBack extends Component {\n\n  onBackClick = (event) => {\n    event.preventDefault();\n    window.history.back();\n  };\n\n  render() {\n    return (\n      <div className=\"go-back\" onClick={this.onBackClick}>\n        <span className=\"fas fa-chevron-left\"></span>\n      </div>\n    );\n  }\n}\n\nexport default GoBack;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { gettext } from '../utils/constants';\nimport { Utils } from '../utils/utils';\nimport toaster from './toast';\n\nconst propTypes = {\n  hasSuffix: PropTypes.bool,\n  name: PropTypes.string.isRequired,\n  onRenameConfirm: PropTypes.func.isRequired,\n  onRenameCancel: PropTypes.func.isRequired,\n};\n\nclass Rename extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      name: props.name\n    };\n    this.inputRef = React.createRef();\n  }\n\n  componentDidMount() {\n    this.inputRef.current.focus();\n    if (this.props.hasSuffix) {\n      var endIndex = this.props.name.lastIndexOf('.');\n      this.inputRef.current.setSelectionRange(0, endIndex, 'forward');\n    } else {\n      this.inputRef.current.setSelectionRange(0, -1);\n    }\n    // ensure real dom has been rendered, then listen the click event\n    setTimeout(() => {\n      document.addEventListener('click', this.onClick);\n    }, 1);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('click', this.onClick);\n  }\n\n  onClick = (e) => {\n    if (!this.inputRef.current.contains(e.target)) {\n      this.onRenameConfirm();\n    }\n  };\n\n  onChange = (e) => {\n    this.setState({name: e.target.value});\n  };\n\n  onKeyDown = (e) => {\n    if (e.keyCode === Utils.keyCodes.enter) {\n      this.onRenameConfirm(e);\n    } else if (e.keyCode === Utils.keyCodes.esc) {\n      this.onRenameCancel(e);\n    }\n    e.nativeEvent.stopImmediatePropagation();\n  };\n\n  onRenameConfirm = (e) => {\n    e && e.nativeEvent.stopImmediatePropagation();\n    let newName = this.state.name.trim();\n    if (newName === this.props.name) {\n      this.props.onRenameCancel();\n      return;\n    }\n\n    let { isValid, errMessage } = this.validateInput();\n    if (!isValid) {\n      toaster.danger(errMessage);\n      this.props.onRenameCancel();\n    } else {\n      this.props.onRenameConfirm(newName);\n    }\n  };\n\n  onRenameCancel = (e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    this.props.onRenameCancel();\n  };\n\n  validateInput = () => {\n    let newName = this.state.name.trim();\n    let isValid = true;\n    let errMessage = '';\n    if (!newName) {\n      isValid = false;\n      errMessage = gettext('Name is required.');\n      return { isValid, errMessage };\n    }\n\n    if (newName.indexOf('/') > -1) {\n      isValid = false;\n      errMessage = gettext('Name should not include ' + '\\'/\\'' + '.');\n      return { isValid, errMessage };\n    }\n\n    return { isValid, errMessage };\n  };\n\n  render() {\n    return (\n      <div className=\"rename-container\">\n        <input\n          ref={this.inputRef}\n          value={this.state.name}\n          onChange={this.onChange}\n          onKeyDown={this.onKeyDown}\n        />\n      </div>\n    );\n  }\n}\n\nRename.propTypes = propTypes;\n\nexport default Rename;\n","import moment from 'moment';\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { Dropdown, DropdownToggle, DropdownMenu, DropdownItem} from 'reactstrap';\nimport { gettext, filePath } from '../../utils/constants';\nimport URLDecorator from '../../utils/url-decorator';\nimport Rename from '../../components/rename';\n\nimport '../../css/history-record-item.css';\n\nmoment.locale(window.app.config.lang);\n\nclass HistoryVersion extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isShowOperationIcon: false,\n      isMenuShow: false,\n      isRenameShow: false,\n    };\n  }\n\n  onMouseEnter = () => {\n    const { currentVersion, historyVersion } = this.props;\n    if (currentVersion.commit_id === historyVersion.commit_id) return;\n    this.setState({ isShowOperationIcon: true });\n  };\n\n  onMouseLeave = () => {\n    const { currentVersion, historyVersion } = this.props;\n    if (currentVersion.commit_id === historyVersion.commit_id) return;\n    this.setState({ isShowOperationIcon: false });\n  };\n\n  onToggleClick = (e) => {\n    this.setState({ isMenuShow: !this.state.isMenuShow });\n  };\n\n  onClick = () => {\n    this.setState({ isShowOperationIcon: false });\n    const { currentVersion, historyVersion } = this.props;\n    if (currentVersion.commit_id === historyVersion.commit_id) return;\n    this.props.onSelectHistoryVersion(historyVersion);\n  };\n\n  onRestore = () => {\n    const { historyVersion } = this.props;\n    this.props.onRestore(historyVersion);\n  };\n\n  onItemDownload = () => {\n    // nothing todo\n  };\n\n  onItemCopy = () => {\n    const { historyVersion } = this.props;\n    historyVersion.ctime_format = moment(historyVersion.ctime).format('YYYY-MM-DD HH:mm');\n    this.props.onCopy(historyVersion);\n  };\n\n  toggleRename = () => {\n    this.setState({isRenameShow: !this.state.isRenameShow});\n  };\n\n  onRenameConfirm = (newName) => {\n    const { obj_id } = this.props.historyVersion;\n    this.props.renameHistoryVersion(obj_id, newName);\n    this.toggleRename();\n  };\n\n  onRenameCancel = () => {\n    this.toggleRename();\n  };\n\n  render() {\n    const { currentVersion, historyVersion } = this.props;\n    if (!currentVersion || !historyVersion) return null;\n    const { ctime, commit_id, creator_name, obj_id, name} = historyVersion;\n    const isHighlightItem = commit_id === currentVersion.commit_id;\n    const url = URLDecorator.getUrl({ type: 'download_historic_file', filePath: filePath, objID: obj_id });\n    return (\n      <li\n        className={`history-list-item ${isHighlightItem ? 'item-active' : ''}`}\n        onMouseEnter={this.onMouseEnter}\n        onMouseLeave={this.onMouseLeave}\n        onClick={this.onClick}\n      >\n        <div className=\"history-info\">\n          {this.state.isRenameShow ?\n            <Rename name={name} onRenameConfirm={this.onRenameConfirm} onRenameCancel={this.onRenameCancel}/>\n            :<div className=\"name\">{name}</div>\n          }\n          <div className=\"time\">{moment(ctime).format('YYYY-MM-DD HH:mm')}</div>\n          <div className=\"owner\">\n            <span className=\"squire-icon\"></span>\n            <span>{creator_name}</span>\n          </div>\n        </div>\n        <div className=\"history-operation\">\n          <Dropdown isOpen={this.state.isMenuShow} toggle={this.onToggleClick}>\n            <DropdownToggle\n              tag='a'\n              className={`fas fa-ellipsis-v ${(this.state.isShowOperationIcon || isHighlightItem) ? '' : 'invisible'}`}\n              data-toggle=\"dropdown\"\n              aria-expanded={this.state.isMenuShow}\n              alt={gettext('More Operations')}\n            />\n            <DropdownMenu>\n              {/* {(this.props.index !== 0) && <DropdownItem onClick={this.onItemRestore}>{gettext('Restore')}</DropdownItem>} */}\n              <DropdownItem tag='a' href={url} onClick={this.onItemDownLoad}>{gettext('Download')}</DropdownItem>\n              {(this.props.index !== 0) && <DropdownItem onClick={this.onItemCopy}>{gettext('Copy')}</DropdownItem>}\n              <DropdownItem onClick={this.toggleRename}>{gettext('Rename')}</DropdownItem>\n            </DropdownMenu>\n          </Dropdown>\n        </div>\n      </li>\n    );\n  }\n}\n\nHistoryVersion.propTypes = {\n  index: PropTypes.number,\n  currentVersion: PropTypes.object.isRequired,\n  historyVersion: PropTypes.object,\n  onSelectHistoryVersion: PropTypes.func.isRequired,\n  onRestore: PropTypes.func.isRequired,\n  onCopy: PropTypes.func.isRequired,\n  renameHistoryVersion: PropTypes.func.isRequired,\n};\n\nexport default HistoryVersion;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\n\nimport '../../../css/switch.css';\n\nfunction Switch(props) {\n  const { onChange, checked, placeholder, disabled, className, size } = props;\n\n  return(\n    <div className={classnames('seahub-switch position-relative', className, size)}>\n      <label className=\"custom-switch\">\n        <input\n          className=\"custom-switch-input\"\n          type=\"checkbox\"\n          checked={checked}\n          onChange={onChange}\n          name=\"custom-switch-checkbox\"\n          disabled={disabled}\n        />\n        <span className=\"custom-switch-description text-truncate\">{placeholder}</span>\n        <span className=\"custom-switch-indicator\"></span>\n      </label>\n    </div>\n  );\n}\n\nSwitch.propTypes = {\n  checked: PropTypes.bool,\n  disabled: PropTypes.bool,\n  placeholder: PropTypes.oneOfType([PropTypes.string, PropTypes.node]),\n  className: PropTypes.string,\n  size: PropTypes.oneOf(['large', 'small', undefined]),\n  onChange: PropTypes.func.isRequired,\n};\n\nexport default Switch;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport Loading from '../../components/loading';\nimport { gettext, historyRepoID, PER_PAGE } from '../../utils/constants';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { Utils } from '../../utils/utils';\nimport editUtilities from '../../utils/editor-utilities';\nimport toaster from '../../components/toast';\nimport HistoryVersion from './history-version';\nimport Switch from '../../components/common/switch';\n\nconst { docUuid } = window.fileHistory.pageOptions;\n\nclass SidePanel extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isLoading: true,\n      historyVersions: [],\n      errorMessage: '',\n      currentPage: 1,\n      hasMore: false,\n      fileOwner: '',\n      isReloadingData: false,\n    };\n  }\n\n  componentDidMount() {\n    seafileAPI.listSdocHistory(docUuid, 1, PER_PAGE).then(res => {\n      let historyList = res.data;\n      if (historyList.length === 0) {\n        this.setState({isLoading: false});\n        throw Error('there has an error in server');\n      }\n      this.initResultState(res.data);\n    });\n  }\n\n  refershFileList() {\n    seafileAPI.listSdocHistory(docUuid, 1, PER_PAGE).then(res => {\n      this.initResultState(res.data);\n    });\n  }\n\n  initResultState(result) {\n    if (result.histories.length) {\n      this.setState({\n        historyVersions: result.histories,\n        currentPage: result.page,\n        hasMore: result.total_count > (PER_PAGE * this.state.currentPage),\n        isLoading: false,\n        fileOwner: result.histories[0].creator_email,\n      });\n      this.props.onSelectHistoryVersion(result.histories[0], result.histories[1]);\n    }\n  }\n\n  updateResultState(result) {\n    if (result.histories.length) {\n      this.setState({\n        historyVersions: [...this.state.historyVersions, ...result.histories],\n        currentPage: result.page,\n        hasMore: result.total_count > (PER_PAGE * this.state.currentPage),\n        isLoading: false,\n        fileOwner: result.histories[0].creator_email\n      });\n    }\n  }\n\n  loadMore = () => {\n    if (!this.state.isReloadingData) {\n      let currentPage = this.state.currentPage + 1;\n      this.setState({\n        currentPage: currentPage,\n        isReloadingData: true,\n      });\n      seafileAPI.listSdocHistory(docUuid, currentPage, PER_PAGE).then(res => {\n        this.updateResultState(res.data);\n        this.setState({isReloadingData: false});\n      });\n    }\n  };\n\n  renameHistoryVersion = (objID, newName) => {\n    seafileAPI.renameSdocHistory(docUuid, objID, newName).then((res) => {\n      this.setState({\n        historyVersions: this.state.historyVersions.map(item => {\n          if (item.obj_id == objID) {\n            item.name = newName;\n          }\n          return item;\n        })\n      });\n    }).catch(error => {\n      const errorMessage = Utils.getErrorMsg(error, true);\n      this.setState({ isLoading: false, errorMessage: errorMessage });\n    });\n  };\n\n  onScrollHandler = (event) => {\n    const clientHeight = event.target.clientHeight;\n    const scrollHeight = event.target.scrollHeight;\n    const scrollTop = event.target.scrollTop;\n    const isBottom = (clientHeight + scrollTop + 1 >= scrollHeight);\n    if (isBottom && this.state.hasMore) {\n      this.loadMore();\n    }\n  };\n\n  restoreVersion = (currentItem) => {\n    const { commit_id, path } = currentItem;\n    editUtilities.revertFile(path, commit_id).then(res => {\n      if (res.data.success) {\n        this.setState({isLoading: true});\n        this.refershFileList();\n      }\n      let message = gettext('Successfully restored.');\n      toaster.success(message);\n    }).catch(error => {\n      const errorMessage = Utils.getErrorMsg(error, true);\n      toaster.danger(gettext(errorMessage));\n    });\n  };\n\n  onSelectHistoryVersion = (historyVersion) => {\n    const { isShowChanges } = this.props;\n    if (!isShowChanges) {\n      this.props.onSelectHistoryVersion(historyVersion);\n      return;\n    }\n    const { historyVersions } = this.state;\n    const historyVersionIndex = historyVersions.findIndex(item => item.commit_id === historyVersion.commit_id);\n    this.props.onSelectHistoryVersion(historyVersion, historyVersions[historyVersionIndex + 1]);\n  };\n\n  copyHistoryFile = (historyVersion) => {\n    const { path, obj_id, ctime_format } = historyVersion;\n    seafileAPI.sdocCopyHistoryFile(historyRepoID, path, obj_id, ctime_format).then(res => {\n      let message = gettext('Successfully copied %(name)s.');\n      let filename = res.data.file_name;\n      message = message.replace('%(name)s', filename);\n      toaster.success(message);\n    }).catch(error => {\n      const errorMessage = Utils.getErrorMsg(error, true);\n      toaster.danger(gettext(errorMessage));\n    });\n  };\n\n  renderHistoryVersions = () => {\n    const { isLoading, historyVersions, errorMessage } = this.state;\n    if (historyVersions.length === 0) {\n      if (isLoading) {\n        return (\n          <div className=\"h-100 w-100 d-flex align-items-center justify-content-center\">\n            <Loading />\n          </div>\n        );\n      }\n      if (errorMessage) {\n        return (\n          <div className=\"h-100 w-100 d-flex align-items-center justify-content-center error-message\">\n            {gettext(errorMessage)}\n          </div>\n        );\n      }\n      return (\n        <div className=\"h-100 w-100 d-flex align-items-center justify-content-center empty-tip-color\">\n          {gettext('No version history')}\n        </div>\n      );\n    }\n\n    return (\n      <>\n        {historyVersions.map((historyVersion, index) => {\n          return (\n            <HistoryVersion\n              key={historyVersion.commit_id}\n              index={index}\n              currentVersion={this.props.currentVersion}\n              historyVersion={historyVersion}\n              onSelectHistoryVersion={this.onSelectHistoryVersion}\n              onRestore={this.restoreVersion}\n              onCopy={this.copyHistoryFile}\n              renameHistoryVersion={this.renameHistoryVersion}\n            />\n          );\n        })}\n        {isLoading && (\n          <div className=\"loading-more d-flex align-items-center justify-content-center w-100\">\n            <Loading />\n          </div>\n        )}\n      </>\n    );\n  };\n\n  onShowChanges = () => {\n    const { isShowChanges, currentVersion } = this.props;\n    const { historyVersions } = this.state;\n    const historyVersionIndex = historyVersions.findIndex(item => item.commit_id === currentVersion.commit_id);\n    const lastVersion = historyVersions[historyVersionIndex + 1];\n    this.props.onShowChanges(!isShowChanges, lastVersion);\n  };\n\n  render() {\n    const { historyVersions } = this.state;\n\n    return (\n      <div className=\"sdoc-file-history-panel h-100 o-hidden d-flex flex-column\">\n        <div className=\"sdoc-file-history-select-range\">\n          <div className=\"sdoc-file-history-select-range-title\">\n            {gettext('History Versions')}\n          </div>\n        </div>\n        <div\n          className={classnames('sdoc-file-history-versions', { 'o-hidden': historyVersions.length === 0 } )}\n          onScroll={this.onScrollHandler}\n        >\n          {this.renderHistoryVersions()}\n        </div>\n        <div className=\"sdoc-file-history-diff-switch d-flex align-items-center\">\n          <Switch\n            checked={this.props.isShowChanges}\n            placeholder={gettext('Show changes')}\n            className=\"sdoc-history-show-changes w-100\"\n            size=\"small\"\n            onChange={this.onShowChanges}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n\nSidePanel.propTypes = {\n  isShowChanges: PropTypes.bool,\n  currentVersion: PropTypes.object,\n  onSelectHistoryVersion: PropTypes.func,\n  onShowChanges: PropTypes.func,\n};\n\nexport default SidePanel;\n","import React from 'react';\nimport ReactDom from 'react-dom';\nimport { UncontrolledTooltip } from 'reactstrap';\nimport classnames from 'classnames';\nimport { DiffViewer } from '@seafile/sdoc-editor';\nimport { seafileAPI } from '../../utils/seafile-api';\nimport { gettext, historyRepoID } from '../../utils/constants';\nimport Loading from '../../components/loading';\nimport GoBack from '../../components/common/go-back';\nimport SidePanel from './side-panel';\nimport { Utils } from '../../utils/utils';\nimport toaster from '../../components/toast';\n\nimport '../../css/layout.css';\nimport '../../css/sdoc-file-history.css';\n\nconst { serviceURL, avatarURL, siteRoot } = window.app.config;\nconst { username, name } = window.app.pageOptions;\nconst { repoID, fileName, filePath, docUuid, assetsUrl  } = window.fileHistory.pageOptions;\n\nwindow.seafile = {\n  repoID,\n  docPath: filePath,\n  docName: fileName,\n  docUuid,\n  isOpenSocket: false,\n  serviceUrl: serviceURL,\n  name,\n  username,\n  avatarURL,\n  siteRoot,\n  assetsUrl,\n};\n\nclass SdocFileHistory extends React.Component {\n\n  constructor(props) {\n    super(props);\n    const isShowChanges = localStorage.getItem('seahub-sdoc-history-show-changes') === 'false' ? false : true;\n    this.state = {\n      isLoading: true,\n      isShowChanges,\n      currentVersion: {},\n      currentVersionContent: '',\n      lastVersionContent: '',\n      changes: [],\n      currentDiffIndex: 0,\n    };\n  }\n\n  onSelectHistoryVersion = (currentVersion, lastVersion) => {\n    this.setState({ isLoading: true, currentVersion });\n    seafileAPI.getFileRevision(historyRepoID, currentVersion.commit_id, currentVersion.path).then(res => {\n      return seafileAPI.getFileContent(res.data);\n    }).then(res => {\n      const currentVersionContent = res.data;\n      if (lastVersion) {\n        seafileAPI.getFileRevision(historyRepoID, lastVersion.commit_id, lastVersion.path).then(res => {\n          return seafileAPI.getFileContent(res.data);\n        }).then(res => {\n          const lastVersionContent = res.data;\n          this.setContent(currentVersionContent, lastVersionContent);\n        }).catch(error => {\n          const errorMessage = Utils.getErrorMsg(error, true);\n          toaster.danger(gettext(errorMessage));\n          this.setContent(currentVersionContent, '');\n        });\n      } else {\n        this.setContent(currentVersionContent, '');\n      }\n    }).catch(error => {\n      const errorMessage = Utils.getErrorMsg(error, true);\n      toaster.danger(gettext(errorMessage));\n      this.setContent('', '');\n    });\n  };\n\n  setContent = (currentVersionContent = '', lastVersionContent = '') => {\n    this.setState({ currentVersionContent, lastVersionContent, isLoading: false, changes: [], currentDiffIndex: 0 });\n  };\n\n  onShowChanges = (isShowChanges, lastVersion) => {\n    if (isShowChanges && lastVersion) {\n      const { currentVersionContent } = this.state;\n      this.setState({ isLoading: true }, () => {\n        localStorage.setItem('seahub-sdoc-history-show-changes', isShowChanges + '');\n        seafileAPI.getFileRevision(historyRepoID, lastVersion.commit_id, lastVersion.path).then(res => {\n          return seafileAPI.getFileContent(res.data);\n        }).then(res => {\n          const lastVersionContent = res.data;\n          this.setContent(currentVersionContent, lastVersionContent);\n          this.setState({ isShowChanges });\n        }).catch(error => {\n          const errorMessage = Utils.getErrorMsg(error, true);\n          toaster.danger(gettext(errorMessage));\n          this.setContent(currentVersionContent, '');\n          this.setState({ isShowChanges });\n        });\n      });\n      return;\n    }\n    this.setState({ isShowChanges }, () => {\n      localStorage.setItem('seahub-sdoc-history-show-changes', isShowChanges + '');\n    });\n  };\n\n  setDiffCount = (diff = { value: [], changes: [] }) => {\n    const { changes } = diff;\n    this.setState({ changes, currentDiffIndex: 0 });\n  };\n\n  jumpToElement = (currentDiffIndex) => {\n    this.setState({ currentDiffIndex }, () => {\n      const { currentDiffIndex, changes } = this.state;\n      const change = changes[currentDiffIndex];\n      const changeElement = document.querySelectorAll(`[data-id=${change}]`)[0];\n      if (changeElement) {\n        this.historyContentRef.scrollTop = changeElement.offsetTop - 10;\n      }\n    });\n  };\n\n  lastChange = () => {\n    const { currentDiffIndex, changes } = this.state;\n    if (currentDiffIndex === 0) {\n      this.jumpToElement(changes.length - 1);\n      return;\n    }\n    this.jumpToElement(currentDiffIndex - 1);\n  };\n\n  nextChange = () => {\n    const { currentDiffIndex, changes } = this.state;\n    if (currentDiffIndex === changes.length - 1) {\n      this.jumpToElement(0);\n      return;\n    }\n    this.jumpToElement(currentDiffIndex + 1);\n  };\n\n  renderChangesTip = () => {\n    const { isShowChanges, changes, currentDiffIndex, isLoading } = this.state;\n    if (isLoading) return null;\n    if (!isShowChanges) return null;\n    const changesCount = changes ? changes.length : 0;\n    if (changesCount === 0) {\n      return (\n        <div className=\"sdoc-file-history-header-right d-flex align-items-center\">\n          <div className=\"sdoc-file-changes-container d-flex align-items-center pl-2 pr-2\">\n            {gettext('No changes')}\n          </div>\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"sdoc-file-history-header-right d-flex align-items-center\">\n        <div className=\"sdoc-file-changes-container d-flex align-items-center\">\n          <div className=\"sdoc-file-changes-tip d-flex align-items-center justify-content-center pl-2 pr-2\">\n            {`${gettext('Changes')} ${currentDiffIndex + 1}/${changesCount}`}\n          </div>\n          <div className=\"sdoc-file-changes-divider\"></div>\n          <div\n            className=\"sdoc-file-changes-last d-flex align-items-center justify-content-center\"\n            id=\"sdoc-file-changes-last\"\n            onClick={this.lastChange}\n          >\n            <span className=\"fas fa-chevron-up\"></span>\n          </div>\n          <div className=\"sdoc-file-changes-divider\"></div>\n          <div\n            className=\"sdoc-file-changes-next d-flex align-items-center justify-content-center\"\n            id=\"sdoc-file-changes-next\"\n            onClick={this.nextChange}\n          >\n            <span className=\"fas fa-chevron-down\"></span>\n          </div>\n          <UncontrolledTooltip placement=\"bottom\" target=\"sdoc-file-changes-last\">\n            {gettext('Last modification')}\n          </UncontrolledTooltip>\n          <UncontrolledTooltip placement=\"bottom\" target=\"sdoc-file-changes-next\">\n            {gettext('Next modification')}\n          </UncontrolledTooltip>\n        </div>\n      </div>\n    );\n  };\n\n  render() {\n    const { currentVersion, isShowChanges, currentVersionContent, lastVersionContent, isLoading } = this.state;\n\n    return (\n      <div className=\"sdoc-file-history d-flex h-100 w-100 o-hidden\">\n        <div className=\"sdoc-file-history-container d-flex flex-column\">\n          <div className=\"sdoc-file-history-header pt-2 pb-2 pl-4 pr-4 d-flex justify-content-between w-100 o-hidden\">\n            <div className={classnames('sdoc-file-history-header-left d-flex align-items-center o-hidden', { 'pr-4': isShowChanges })}>\n              <GoBack />\n              <div className=\"file-name text-truncate\">{fileName}</div>\n            </div>\n            {this.renderChangesTip()}\n          </div>\n          <div className=\"sdoc-file-history-content f-flex flex-column\" ref={ref => this.historyContentRef = ref}>\n            {isLoading ? (\n              <div className=\"sdoc-file-history-viewer d-flex align-items-center justify-content-center\">\n                <Loading />\n              </div>\n            ) : (\n              <DiffViewer\n                currentContent={currentVersionContent}\n                lastContent={isShowChanges ? lastVersionContent : ''}\n                didMountCallback={this.setDiffCount}\n              />\n            )}\n          </div>\n        </div>\n        <SidePanel\n          isShowChanges={isShowChanges}\n          currentVersion={currentVersion}\n          onSelectHistoryVersion={this.onSelectHistoryVersion}\n          onShowChanges={this.onShowChanges}\n        />\n      </div>\n    );\n  }\n}\n\nReactDom.render(<SdocFileHistory />, document.getElementById('wrapper'));\n"],"names":["GoBack","_Component","_inherits","_super","_createSuper","_this","_classCallCheck","_len","arguments","length","args","Array","_key","call","apply","concat","onBackClick","event","preventDefault","window","history","back","_createClass","key","value","_jsx","className","onClick","this","children","Component","Rename","_React$Component","props","e","inputRef","current","contains","target","onRenameConfirm","onChange","setState","name","onKeyDown","keyCode","Utils","keyCodes","enter","esc","onRenameCancel","nativeEvent","stopImmediatePropagation","newName","state","trim","_this$validateInput","validateInput","isValid","errMessage","toaster","danger","indexOf","gettext","React","_this2","focus","hasSuffix","endIndex","lastIndexOf","setSelectionRange","setTimeout","document","addEventListener","removeEventListener","ref","moment","app","config","lang","HistoryVersion","onMouseEnter","_this$props","currentVersion","historyVersion","commit_id","isShowOperationIcon","onMouseLeave","_this$props2","onToggleClick","isMenuShow","_this$props3","onSelectHistoryVersion","onRestore","onItemDownload","onItemCopy","ctime_format","ctime","format","onCopy","toggleRename","isRenameShow","obj_id","renameHistoryVersion","_this$props4","creator_name","isHighlightItem","url","URLDecorator","getUrl","type","filePath","objID","_jsxs","Dropdown","isOpen","toggle","DropdownToggle","tag","alt","DropdownMenu","DropdownItem","href","onItemDownLoad","index","checked","placeholder","disabled","size","classnames","docUuid","fileHistory","pageOptions","SidePanel","loadMore","isReloadingData","currentPage","seafileAPI","listSdocHistory","PER_PAGE","then","res","updateResultState","data","renameSdocHistory","historyVersions","map","item","catch","error","errorMessage","getErrorMsg","isLoading","onScrollHandler","clientHeight","scrollHeight","scrollTop","hasMore","restoreVersion","currentItem","path","editUtilities","revertFile","success","refershFileList","message","isShowChanges","historyVersionIndex","findIndex","copyHistoryFile","sdocCopyHistoryFile","historyRepoID","filename","file_name","replace","renderHistoryVersions","_this$state","Loading","_Fragment","onShowChanges","lastVersion","fileOwner","Error","initResultState","_this3","result","histories","page","total_count","creator_email","_toConsumableArray","onScroll","Switch","_window$app$config","serviceURL","avatarURL","siteRoot","_window$app$pageOptio","username","_window$fileHistory$p","repoID","fileName","assetsUrl","seafile","docPath","docName","isOpenSocket","serviceUrl","SdocFileHistory","getFileRevision","getFileContent","currentVersionContent","lastVersionContent","setContent","undefined","changes","currentDiffIndex","localStorage","setItem","setDiffCount","jumpToElement","change","changeElement","querySelectorAll","historyContentRef","offsetTop","lastChange","_this$state2","nextChange","_this$state3","renderChangesTip","_this$state4","changesCount","id","UncontrolledTooltip","placement","getItem","_this$state5","DiffViewer","currentContent","lastContent","didMountCallback","ReactDom","getElementById"],"sourceRoot":""}